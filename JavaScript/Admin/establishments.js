Backendless.serverURL="https://api.backendless.com",Backendless.initApp("073669A8-CCB7-2AED-FFEC-841A4CE5F400","FAFDE171-5308-49CF-9980-AA89E4F28F0C");var cellID,masterEstablishments=[],Australia=!0;function logoutUser(){localStorage.setItem("userStatus","logged_out"),window.location.href="../admin.html"}function onPageLoadTable(e){$("#myTable tr").remove();var t=document.getElementById("myTable"),n=Backendless.DataQueryBuilder.create();n.setRelated(["establishmentSpecials"]),1==Australia?n.setWhereClause("Country = 'Australia'"):n.setWhereClause("Country = 'New Zealand'"),n.setSortBy(["Name"]),n.setPageSize(100).setOffset(0),Backendless.Data.of("Establishment").find(n).then(function(e){for(var n=0;n<e.length;n++)addRow(t,e[n].Name,e[n].Address,e[n].Suburb,e[n].Postcode,e[n].objectId,e[n].objectId);return addRowHandlers(),masterEstablishments=e}).catch(function(e){}).then(()=>{displaySpecials()}).then(()=>{$("#tbl").scrollTop(e)}).then(()=>{var e=document.getElementById("myInput").value;e=e.toLowerCase(),$("#myTable tr").filter(function(){$(this).toggle($(this).text().toLowerCase().indexOf(e)>-1)})})}function addCell(e,t,n){var a=document.createElement("td");a.id=n,a.innerHTML=t,e.appendChild(a)}function addCellHidden(e,t,n){var a=document.createElement("td");a.id=n,a.innerHTML=t,a.classList.add("cell-hidden"),e.appendChild(a)}function addRow(e,t,n,a,d,s,l){var i=document.createElement("tr");addCell(i,t,s),addCell(i,n,l),addCellHidden(i,a),addCellHidden(i,d),e.appendChild(i)}function addRowHandlers(){var e=document.getElementById("tbl"),t=e.getElementsByTagName("tr");for(i=0;i<t.length;i++){var n=e.rows[i];n.onclick=function(e){return function(){var t=e.getElementsByTagName("td")[0].id;cellID=t,displaySpecials()}}(n)}}function checkBoxAddToEstablishmentFunc(){if(""==document.getElementById("establishmentId").value)alert("You need to select a valid establishment"),document.getElementById("chkBoxAddToEstablishment").checked=!1;else if(1==document.getElementById("chkBoxAddToEstablishment").checked){document.getElementById("or").style.display="none",document.getElementById("addSpecialSubHeading").innerHTML="<h5>Adding special to "+document.getElementById("name").value+"</h5>",document.getElementById("add_name").value=document.getElementById("name").value,document.getElementById("add_name").disabled=!0,document.getElementById("add_address").value=document.getElementById("address").value,document.getElementById("add_address").disabled=!0,document.getElementById("add_suburb").value=document.getElementById("suburb").value,document.getElementById("add_suburb").disabled=!0,document.getElementById("add_postcode").value=document.getElementById("postcode").value,document.getElementById("add_postcode").disabled=!0,"Establishments - Australia"==document.getElementById("headingLstBoxEstablishments").innerHTML?(document.getElementById("add_country").value="Australia",document.getElementById("add_country").disabled=!0):(document.getElementById("add_country").value="New Zealand",document.getElementById("add_country").disabled=!0),document.getElementById("add_establishment_type").value=document.getElementById("establishmentType").value,document.getElementById("add_establishment_type").disabled=!0;var e=document.getElementById("cusineType").value.split(", ");$("#add_cusine_type").val(e),document.getElementById("add_cusine_type").disabled=!0,document.getElementById("add_google_link").value=document.getElementById("googleLink").value,document.getElementById("add_google_link").disabled=!0,document.getElementById("add_website_link").value=document.getElementById("websiteLink").value,document.getElementById("add_website_link").disabled=!0,document.getElementById("files").disabled=!0,document.getElementById("filesText").value=document.getElementById("image-file-name").innerHTML,document.getElementById("filesText").disabled=!0,document.getElementById("chkBoxAddDefaultImg").checked=!1,document.getElementById("chkBoxAddDefaultImg").disabled=!0,document.getElementById("skipSpecial").style.display="none",$("select").formSelect(),M.updateTextFields()}else{document.getElementById("or").style.display="block",document.getElementById("addSpecialSubHeading").innerHTML="<h5>Create for a new establishment</h5>",enableEstablishmentDetails(),addspecialForm=document.querySelector("#addspecial-form"),addspecialForm.reset();var t=document.getElementById("name").value+" | "+document.getElementById("address").value;" | "==t&&(t="Please select an existing establishment."),document.getElementById("addToExistingEstablishment").value=t,document.getElementById("addToExistingEstablishment").name=document.getElementById("establishmentId").value,document.getElementById("skipSpecial").style.display="block",$("select").formSelect(),M.updateTextFields()}}function checkBoxAddDefaultImg(){1==document.getElementById("chkBoxAddDefaultImg").checked?(document.getElementById("files").disabled=!0,document.getElementById("filesText").disabled=!0):(document.getElementById("files").disabled=!1,document.getElementById("filesText").disabled=!1)}function checkBoxUpdateDefaultImg(){1==document.getElementById("chkBoxUpdateDefaultImg").checked?(document.getElementById("updateFiles").disabled=!0,document.getElementById("updateFilesText").disabled=!0):(document.getElementById("updateFiles").disabled=!1,document.getElementById("updateFilesText").disabled=!1)}function removeOptions(e){var t;for(t=e.options.length-1;t>=0;t--)e.remove(t)}function displaySpecials(){document.getElementById("formSpecialDetails").style.display="none",document.getElementById("formEstablishmentDetails").style.display="block";var e=document.getElementById("establishmentId"),t=document.getElementById("name"),n=document.getElementById("address"),a=document.getElementById("suburb"),d=document.getElementById("postcode"),s=document.getElementById("country"),l=document.getElementById("establishmentType"),i=document.getElementById("cusineType"),o=document.getElementById("googleLink"),m=document.getElementById("websiteLink"),c=document.getElementById("image"),r=document.getElementById("image-file-name");document.getElementById("formHeading").innerHTML="Establishment details";for(var u=cellID,g=0;g<masterEstablishments.length;g++)masterEstablishments[g].objectId==u&&(e.value=masterEstablishments[g].objectId,t.value=masterEstablishments[g].Name,n.value=masterEstablishments[g].Address,a.value=masterEstablishments[g].Suburb,d.value=masterEstablishments[g].Postcode,s.value=masterEstablishments[g].Country,l.value=masterEstablishments[g].Establishment_Type,i.value=masterEstablishments[g].Cuisine_Type,o.value=masterEstablishments[g].Google_Business_Link,m.value=masterEstablishments[g].Website_Link,c.src=masterEstablishments[g].Image,r.innerHTML=/[^\/]*$/.exec(masterEstablishments[g].Image)[0]);var y,h=document.getElementById("specialListBox");removeOptions(h);for(g=0;g<masterEstablishments.length;g++)if(u==masterEstablishments[g].objectId){y=g;for(var p=0;p<masterEstablishments[y].establishmentSpecials.length;p++){var b=p+1+". "+masterEstablishments[y].establishmentSpecials[p].Category.replace("Special ","")+" - "+masterEstablishments[y].establishmentSpecials[p].Description;b.length>45&&(b=b.substring(0,45)+".."),h.options[p]=new Option(b,masterEstablishments[y].objectId)}break}M.updateTextFields()}function getSpecial(){try{document.getElementById("formEstablishmentDetails").style.display="none",document.getElementById("formSpecialDetails").style.display="block",document.getElementById("formHeading").innerHTML="Special details";for(var e=document.getElementById("specialListBox"),t=e.options[e.selectedIndex].value,n=e.options[e.selectedIndex].index,a=0;a<masterEstablishments.length;a++)if(t==masterEstablishments[a].objectId){document.getElementById("establishmentIdSpecial").value=masterEstablishments[a].objectId,document.getElementById("specialId").value=masterEstablishments[a].establishmentSpecials[n].objectId;var d=masterEstablishments[a].establishmentSpecials[n].Days_Of_Week;if(document.getElementById("daysOfWeek").value=d,document.getElementById("startTime").value=tConvert(masterEstablishments[a].establishmentSpecials[n].Start_Time),document.getElementById("endTime").value=tConvert(masterEstablishments[a].establishmentSpecials[n].End_Time),document.getElementById("category").value=masterEstablishments[a].establishmentSpecials[n].Category,document.getElementById("typeOfSpecial").value=masterEstablishments[a].establishmentSpecials[n].Type_Of_Special,document.getElementById("descriptionFullText").value=masterEstablishments[a].establishmentSpecials[n].Description,masterEstablishments[a].establishmentSpecials[n].Description.length>125){var s=masterEstablishments[a].establishmentSpecials[n].Description;document.getElementById("description").value=s.substring(0,121)+" ...",$("#tooltip").attr("data-tooltip",masterEstablishments[a].establishmentSpecials[n].Description),$(".material-tooltip").css({display:"block"})}else if(masterEstablishments[a].establishmentSpecials[n].Description.length<=125){document.getElementById("description").value=masterEstablishments[a].establishmentSpecials[n].Description,$("#tooltip").attr("data-tooltip","Less than 125"),$(".material-tooltip").css({display:"none"})}break}M.textareaAutoResize($("#description")),M.updateTextFields()}catch(e){console.log(e),document.getElementById("specialId").value="",document.getElementById("daysOfWeek").value="",document.getElementById("startTime").value="",document.getElementById("endTime").value="",document.getElementById("category").value="",document.getElementById("typeOfSpecial").value="",document.getElementById("description").value="",$(".material-tooltip").css({display:"none"})}}function displayAus(){"Establishments - Australia"!=document.getElementById("headingLstBoxEstablishments").innerHTML&&($("#myInput").val(""),Australia=!0,onPageLoadTable(),$("#specialListBox").empty(),displayEstablishmentandSpecialForm=document.querySelector("#displayEstablishmentandSpecial-form"),displayEstablishmentandSpecialForm.reset(),document.getElementById("headingLstBoxEstablishments").innerHTML="Establishments - Australia")}function displayNZ(){"Establishments - New Zealand"!=document.getElementById("headingLstBoxEstablishments").innerHTML&&($("#myInput").val(""),Australia=!1,onPageLoadTable(),$("#specialListBox").empty(),displayEstablishmentandSpecialForm=document.querySelector("#displayEstablishmentandSpecial-form"),displayEstablishmentandSpecialForm.reset(),document.getElementById("headingLstBoxEstablishments").innerHTML="Establishments - New Zealand")}function toastNotification(e,t,n,a,d,s,l){M.toast({html:'<div class="toast-side"></div><div class="toast-notification-con"><img class="'+t+'" src="../images/'+n+'"><div class="toast-message">'+e+'</div><img class="toast-close" src="../images/toast-close.png" height="16" width="16"></div>',displayLength:d,classes:""+a,outDuration:l}),$(".toast-side").css({"background-color":s}),$(document).on("click",".toast-close",function(){$("#toast-container .toast").fadeOut(500,function(){$("#toast-container .toast").remove()})})}function enableEstablishmentDetails(){document.getElementById("add_name").disabled=!1,document.getElementById("add_address").disabled=!1,document.getElementById("add_suburb").disabled=!1,document.getElementById("add_postcode").disabled=!1,document.getElementById("add_country").disabled=!1,document.getElementById("add_establishment_type").disabled=!1,document.getElementById("add_cusine_type").disabled=!1,document.getElementById("add_google_link").disabled=!1,document.getElementById("add_website_link").disabled=!1,document.getElementById("files").disabled=!1,document.getElementById("filesText").disabled=!1,document.getElementById("chkBoxAddDefaultImg").disabled=!1,$("select").formSelect()}function enableCreateCustomImage(){document.getElementById("files").disabled=!1,document.getElementById("filesText").disabled=!1}function enableUpdateCustomImage(){document.getElementById("updateFiles").disabled=!1,document.getElementById("updateFilesText").disabled=!1}function tConvert(e){return(e=e.toString().match(/^([01]\d|2[0-3])(:)([0-5]\d)(:[0-5]\d)?$/)||[e]).length>1&&((e=e.slice(1))[5]=+e[0]<12?" AM":" PM",e[0]=+e[0]%12||12),e.join("")}function convertTo24Hour2(e){time=document.getElementById(e).value;var t=Number(time.match(/^(\d+)/)[1]),n=Number(time.match(/:(\d+)/)[1]),a=time.match(/\s(.*)$/)[1];"PM"==a&&t<12&&(t+=12),"AM"==a&&12==t&&(t-=12);var d=t.toString(),s=n.toString();return t<10&&(d="0"+d),n<10&&(s="0"+s),d+":"+s}function endAnimations(){document.getElementById("workingAnim").style.display="none",document.getElementById("h5workingAnimMessage").style.display="none"}document.addEventListener("DOMContentLoaded",function(){onPageLoadTable();const e=localStorage.getItem("currentUser");document.getElementById("userEmail").innerHTML="Hi, "+e,$(".tabs").tabs(),$("select").formSelect(),$(".modal").modal(),$("input#input_text, textarea#add_description").characterCounter(),$("input#input_text, textarea#update_description").characterCounter(),M.textareaAutoResize($("#description")),$(".modal-add").modal({startingTop:"4%"}),$(".tooltipped").tooltip(),$(".sidenav").sidenav()}),$("#myInput").on("keyup",function(){var e=$(this).val().toLowerCase();$("#myTable tr").filter(function(){$(this).toggle($(this).text().toLowerCase().indexOf(e)>-1)})}),$(function(){$("#tbl").on("click","tbody tr",function(e){$(this).addClass("selected-row").siblings().removeClass("selected-row")})}),addBtn.addEventListener("click",e=>{e.preventDefault(),M.Toast.dismissAll(),document.getElementById("addConfirmBtn").classList.remove("modal-close"),document.getElementById("addSkipSpecialBtn").classList.remove("modal-close");var t=document.getElementById("name").value+" | "+document.getElementById("address").value;if(" | "==t&&(t="Please select an existing establishment."),document.getElementById("addToExistingEstablishment").value=t,document.getElementById("addToExistingEstablishment").name=document.getElementById("establishmentId").value,0==document.getElementById("chkBoxAddToEstablishment").checked){var n=Backendless.DataQueryBuilder.create();return n.setSortBy(["Name"]),n.setPageSize(100).setOffset(0),Backendless.Data.of("Cuisine").find(n).then(function(e){var t=document.getElementById("add_cusine_type");$("#add_cusine_type").empty();var n=1,a=0,d=e.length;for(a=0;a<d;a++)t.options[0]=new Option("Choose your cuisine type",""),t.options[0].disabled=!0,t.options[n]=new Option(e[a].Name,e[a].Name),n++;$("select").formSelect()}).catch(function(e){})}}),addConfirmBtn.addEventListener("click",e=>{if(M.Toast.dismissAll(),0==document.getElementById("chkBoxAddToEstablishment").checked){console.log("Create new establishment and special concurrently");var t=document.getElementById("add_name").value.trim(),n=document.getElementById("add_postcode").value.trim(),a=document.getElementById("add_country").value,d=document.getElementById("add_establishment_type").value,s=$("#add_cusine_type").val().join(", "),l=document.getElementById("filesText").value.trim(),i=document.getElementById("add_google_link").value.trim(),o=document.getElementById("add_website_link").value.trim(),m=document.getElementById("chkBoxAddDefaultImg").checked,c=document.getElementById("add_address").value.trim(),r=document.getElementById("add_suburb").value.trim(),u=$("#add_days_of_the_week").val().join(", "),g=document.getElementById("add_start_time").value,y=document.getElementById("add_end_time").value,h=document.getElementById("add_category").value,p=document.getElementById("add_type_of_special").value,b=document.getElementById("add_description").value.trim();if(""==t||t.length>50||""==c||c.length>100||""!=c&&!c.match(/^[a-zA-Z0-9\/\-\&  ]+$/)||""==r||r.length>50||""!=r&&!r.match(/^[A-Za-z ]+$/)||""==n||4!=n.length||""!=n&&!n.match(/^[0-9]+$/)||""==a||""==s||i.length>100||o.length>100||""==l&&0==m||""==g||""==y||""==h||""==p||""==b||b.length>500){var E="";""==t&&(E+='"Name" is required!<br>'),t.length>50&&(E+='"Name" must not exceed 50 characters!<br>'),""==c&&(E+='"Address" is required!<br>'),c.length>100&&(E+='"Address" must not exceed 100 characters!<br>'),""==c||c.match(/^[a-zA-Z0-9\/\-\&  ]+$/)||(E+='"Address" contains non-alphanumerical characters! Exception ("/", "-", "&").<br>'),""==r&&(E+='"Suburb" is required!<br>'),r.length>50&&(E+='"Suburb" must not exceed 50 characters!<br>'),""==r||r.match(/^[A-Za-z ]+$/)||(E+='"Suburb" contains non-alphabetic characters!<br>'),""==n&&(E+='"Postcode" is required!<br>'),4!=n.length&&(E+='"Postcode" must be 4 numbers!<br>'),""==n||n.match(/^[0-9]+$/)||(E+='"Postcode" contains non-numerical characters!<br>'),""==a&&(E+='"Country" is required!<br>'),""==s&&(E+='"Cuisine Type" is required!<br>'),i.length>100&&(E+='"Google Buisness Link" must not exceed 100 characters!<br>'),o.length>100&&(E+='"Website Link" must not exceed 100 characters!<br>'),""==l&&0==m&&(E+='"Image" is required!<br>'),""==g&&(E+='"Start time" is required!<br>'),""==y&&(E+='"End time" is required!<br>'),""==h&&(E+='"Category" is required!<br>'),""==p&&(E+='"Type of special" is required!<br>'),""==b&&(E+='"Description" is required!<br>'),b.length>500&&(E+='"Description" must not exceed 500 characters!<br>'),toastNotification(E,"toast-error","error-symbol.png","red lighten-1","Infinity","#ce5548",0),e.preventDefault()}else{var B;document.getElementById("addConfirmBtn").classList.add("modal-close"),document.getElementById("workingAnim").style.display="block",document.getElementById("h5workingAnimMessage").innerHTML="Creating",document.getElementById("h5workingAnimMessage").style.display="block";var I,f,v=c+" "+r,_=[];axios.get("https://maps.googleapis.com/maps/api/geocode/json?components=country:NZ|country:AU",{params:{address:v,key:"AIzaSyBmpzz0lX4w2UV3KXivbLrQ3AHJUvOzbOI"}}).then(function(e){return I=e.data.results[0].geometry.location.lat,f=e.data.results[0].geometry.location.lng,_.push(I),_.push(f),_}).then(()=>{if(1!=m)return file=document.getElementById("files").files[0],Backendless.Files.upload(file,"images").then(function(e){B=e.fileURL}).catch(function(e){"Error: Unable to upload the file: file already exists"==e&&(toastNotification("A file with the name "+document.getElementById("files").files[0].name+" already exists.","toast-error","error-symbol.png","red lighten-1","Infinity","#ce5548",0),endAnimations())});B="https://backendlessappcontent.com/073669A8-CCB7-2AED-FFEC-841A4CE5F400/CCB6BFB7-82E5-4240-A911-5E169AEA70F2/files/images/default.jpg"}).then(()=>{Promise.all([(()=>{var e={Google_Business_Link:i,Website_Link:o,Image:B,Location:(new Backendless.Data.Point).setLatitude(_[0]).setLongitude(_[1]),Name:t,Address:c,Suburb:r,Postcode:n,Country:a,Cuisine_Type:s,Establishment_Type:d};return Backendless.Data.of("Establishment").save(e).then(e=>e.objectId)})(),(()=>{""==u&&(u="Monday, Tuesday, Wednesday, Thursday, Friday, Saturday, Sunday");var e={Days_Of_Week:u,Start_Time:g,End_Time:y,Category:h,Type_Of_Special:p,Description:b};return Backendless.Data.of("Special").save(e).then(e=>e.objectId)})()]).then(([e,t])=>{var n={objectId:e},a=[{objectId:t}];return cellID=e,Backendless.Data.of("Establishment").addRelation(n,"establishmentSpecials",a).then(function(e){})}).then(()=>{onPageLoadTable()}).then(()=>{document.getElementById("workingAnim").style.display="none"}).then(()=>{document.getElementById("h5workingAnimMessage").style.display="none"}).then(()=>{toastNotification("Establishment and Special has been created successfully!","toast-tick","white-check-mark.png","light-blue darken-2",4e3,"#0277bd",375)}).then(()=>{document.querySelector("#addspecial-form").reset()}).then(()=>{M.updateTextFields()}).catch(e=>{"TypeError: Cannot read property 'geometry' of undefined"==e&&(toastNotification("An error was encountered while handling the request. The address and/or suburb was unable to be identified.","toast-error","error-symbol.png","red lighten-1","Infinity","#ce5548",0),endAnimations(),console.error(e)),"Error: Field 'Image' doesn't have a default value"==e?endAnimations():(toastNotification(e.message,"toast-error","error-symbol.png","red lighten-1","Infinity","#ce5548",0),endAnimations())})})}}else if(1==document.getElementById("chkBoxAddToEstablishment").checked){u=$("#add_days_of_the_week").val().join(", "),g=document.getElementById("add_start_time").value,y=document.getElementById("add_end_time").value,h=document.getElementById("add_category").value,p=document.getElementById("add_type_of_special").value,b=document.getElementById("add_description").value.trim();if(""==g||""==y||""==h||""==p||""==b||b.length>500){E="";""==g&&(E+='"Start time" is required!<br>'),""==y&&(E+='"End time" is required!<br>'),""==h&&(E+='"Category" is required!<br>'),""==p&&(E+='"Type of special" is required!<br>'),""==b&&(E+='"Description" is required!<br>'),b.length>500&&(E+='"Description" must not exceed 500 characters!<br>'),toastNotification(E,"toast-error","error-symbol.png","red lighten-1","Infinity","#ce5548",0)}else{document.getElementById("addConfirmBtn").classList.add("modal-close"),document.getElementById("workingAnim").style.display="block",document.getElementById("h5workingAnimMessage").innerHTML="Creating",document.getElementById("h5workingAnimMessage").style.display="block";const e=()=>establishmentObjectId=document.getElementById("addToExistingEstablishment").name,t=()=>{""==u&&(u="Monday, Tuesday, Wednesday, Thursday, Friday, Saturday, Sunday");var e={Days_Of_Week:u,Start_Time:g,End_Time:y,Category:h,Type_Of_Special:p,Description:b};return Backendless.Data.of("Special").save(e).then(e=>e.objectId)};Promise.all([e(),t()]).then(([e,t])=>{var n={objectId:e},a=[{objectId:t}];return cellID=e,Backendless.Data.of("Establishment").addRelation(n,"establishmentSpecials",a).then(function(e){}).catch(function(e){})}).then(()=>{onPageLoadTable()}).then(()=>{endAnimations()}).then(()=>{toastNotification("Special has been created successfully!","toast-tick","white-check-mark.png","light-blue darken-2",4e3,"#0277bd",375)}).then(()=>{document.querySelector("#addspecial-form").reset()}).then(()=>{enableEstablishmentDetails()}).then(()=>{document.getElementById("or").style.display="block",document.getElementById("addSpecialSubHeading").innerHTML="<h5>Create for a new establishment</h5>",document.getElementById("skipSpecial").style.display="block"}).then(()=>{M.updateTextFields()}).catch(e=>{console.error(e)})}}}),addCancelBtn.addEventListener("click",e=>{e.preventDefault(),M.Toast.dismissAll(),document.getElementById("addCancelBtn").setAttribute("href","#");var t=document.getElementById("add_name").value.trim(),n=document.getElementById("add_country").value,a=document.getElementById("add_postcode").value.trim(),d=document.getElementById("add_establishment_type").value,s=document.getElementById("add_cusine_type").value,l=document.getElementById("filesText").value.trim(),i=document.getElementById("chkBoxAddDefaultImg").checked,o=document.getElementById("add_address").value.trim(),m=document.getElementById("add_suburb").value.trim(),c=$("#add_days_of_the_week").val().join(", "),r=document.getElementById("add_start_time").value,u=document.getElementById("add_end_time").value,g=document.getElementById("add_category").value,y=document.getElementById("add_type_of_special").value,h=document.getElementById("add_description").value.trim(),p=!0;(0!=document.getElementById("chkBoxAddToEstablishment").checked||""!=t||""!=o||""!=m||""!=a||""!=n||"N/A"!=d||""!=s||""!=l||0!=i)&&1!=document.getElementById("chkBoxAddToEstablishment").checked||""!=c||""!=r&&"18:00"!=r||""!=u&&"21:00"!=u||"Dinner Special"!=g||""!=y||""!=h||($("#modal1").modal("close"),enableEstablishmentDetails(),addspecialForm=document.querySelector("#addspecial-form"),addspecialForm.reset(),document.getElementById("addSpecialSubHeading").innerHTML="<h5>Create for a new establishment</h5>",p=!1),1==p&&document.getElementById("addCancelBtn").setAttribute("href","#modalAddCancelConfirm")}),addCancelConfirmDiscardBtn.addEventListener("click",e=>{addspecialForm=document.querySelector("#addspecial-form"),addspecialForm.reset(),enableEstablishmentDetails(),document.getElementById("addSpecialSubHeading").innerHTML="<h5>Create for a new establishment</h5>",$("select").formSelect(),$("#modal1").modal("close"),$("#modalAddCancelConfirm").modal("close"),$("input#input_text, textarea#add_description").characterCounter()}),addSkipSpecialBtn.addEventListener("click",e=>{e.preventDefault(),M.Toast.dismissAll();var t=document.getElementById("add_address").value.trim(),n=document.getElementById("add_suburb").value.trim(),a=document.getElementById("add_name").value.trim(),d=document.getElementById("add_postcode").value.trim(),s=document.getElementById("add_country").value,l=document.getElementById("add_establishment_type").value,i=$("#add_cusine_type").val().join(", "),o=document.getElementById("filesText").value,m=document.getElementById("add_google_link").value.trim(),c=document.getElementById("add_website_link").value.trim(),r=document.getElementById("chkBoxAddDefaultImg").checked;if(""==a||a.length>50||""==t.trim()||t.length>100||""!=t&&!t.match(/^[a-zA-Z0-9\/\-\& ]+$/)||""==n||n.length>50||""!=n&&!n.match(/^[A-Za-z ]+$/)||""==d||4!=d.length||""!=d&&!d.match(/^[0-9]+$/)||""==s||""==i||m.length>100||c.length>100||""==o&&0==r){var u="";""==a&&(u+='"Name" is required!<br>'),a.length>50&&(u+='"Name" must not exceed 50 characters!<br>'),""==t&&(u+='"Address" is required!<br>'),t.length>100&&(u+='"Address" must not exceed 100 characters!<br>'),""==t||t.match(/^[a-zA-Z0-9\/\-\& ]+$/)||(u+='"Address" contains non-alphanumerical characters! Exception ("/", "-", "&").<br>'),""==n&&(u+='"Suburb" is required!<br>'),n.length>50&&(u+='"Suburb" must not exceed 50 characters!<br>'),""==n||n.match(/^[A-Za-z ]+$/)||(u+='"Suburb" contains non-alphabetic characters!<br>'),""==d&&(u+='"Postcode" is required!<br>'),4!=d.length&&(u+='"Postcode" must be 4 numbers!<br>'),""==d||d.match(/^[0-9]+$/)||(u+='"Postcode" contains non-numerical characters!<br>'),""==s&&(u+='"Country" is required!<br>'),""==i&&(u+='"Cuisine Type" is required!<br>'),m.length>100&&(u+='"Google Buisness Link" must not exceed 100 characters!<br>'),c.length>100&&(u+='"Website Link" must not exceed 100 characters!<br>'),""==o&&0==r&&(u+='"Image" is required!<br>'),toastNotification(u,"toast-error","error-symbol.png","red lighten-1","Infinity","#ce5548",0)}else{var g;document.getElementById("addSkipSpecialBtn").classList.add("modal-close"),document.getElementById("workingAnim").style.display="block",document.getElementById("h5workingAnimMessage").innerHTML="Creating",document.getElementById("h5workingAnimMessage").style.display="block";var y,h,p=t+" "+n,b=[];axios.get("https://maps.googleapis.com/maps/api/geocode/json?components=country:NZ|country:AU",{params:{address:p,key:"AIzaSyBmpzz0lX4w2UV3KXivbLrQ3AHJUvOzbOI"}}).then(function(e){return y=e.data.results[0].geometry.location.lat,h=e.data.results[0].geometry.location.lng,b.push(y),b.push(h),b}).then(()=>{if(1!=r)return file=document.getElementById("files").files[0],Backendless.Files.upload(file,"images").then(function(e){g=e.fileURL});g="https://backendlessappcontent.com/073669A8-CCB7-2AED-FFEC-841A4CE5F400/CCB6BFB7-82E5-4240-A911-5E169AEA70F2/files/images/default.jpg"}).then(()=>{console.log("4. Create establishment");var e={Google_Business_Link:m,Website_Link:c,Image:g,Location:(new Backendless.Data.Point).setLatitude(b[0]).setLongitude(b[1]),Name:a,Address:t,Suburb:n,Postcode:d,Country:s,Cuisine_Type:i,Establishment_Type:l};return Backendless.Data.of("Establishment").save(e).then(function(e){cellID=e.objectId})}).then(()=>{onPageLoadTable()}).then(()=>{document.querySelector("#addspecial-form").reset()}).then(()=>{enableCreateCustomImage()}).then(()=>{M.updateTextFields()}).then(()=>{document.getElementById("workingAnim").style.display="none"}).then(()=>{document.getElementById("h5workingAnimMessage").style.display="none"}).then(()=>{toastNotification("Establishment has been created successfully!","toast-tick","white-check-mark.png","light-blue darken-2",4e3,"#0277bd",375)}).catch(e=>{"TypeError: Cannot read property 'geometry' of undefined"==e&&(toastNotification("An error was encountered while handling the request. The address and/or suburb was unable to be identified.","toast-error","error-symbol.png","red lighten-1","Infinity","#ce5548",0),endAnimations(),console.error(e)),"Error: Unable to upload the file: file already exists"==e?(toastNotification("A file with the name "+document.getElementById("files").files[0].name+" already exists.","toast-error","error-symbol.png","red lighten-1","Infinity","#ce5548",0),endAnimations()):(toastNotification(e.message,"toast-error","error-symbol.png","red lighten-1","Infinity","#ce5548",0),endAnimations()),console.error(e)})}}),updateBtn.addEventListener("click",e=>{if(e.preventDefault(),M.Toast.dismissAll(),""==document.getElementById("establishmentId").value)document.getElementById("updateBtn").setAttribute("href","#"),toastNotification("No establishment or special selected.","toast-error","error-symbol.png","red lighten-1","Infinity","#ce5548",0);else{if("Establishment details"==document.getElementById("formHeading").innerHTML){document.getElementById("updateBtn").setAttribute("href","#modal2"),document.getElementById("formUpdateSpecialDetails").style.display="none",document.getElementById("formUpdateEstablishmentDetails").style.display="block",document.getElementById("updateHeading").innerHTML="Update establishment",document.getElementById("update_establishmentId").value=document.getElementById("establishmentId").value,document.getElementById("update_name").value=document.getElementById("name").value,document.getElementById("update_address").value=document.getElementById("address").value,document.getElementById("update_suburb").value=document.getElementById("suburb").value,document.getElementById("update_postcode").value=document.getElementById("postcode").value,document.getElementById("update_country").value=document.getElementById("country").value,document.getElementById("update_google_link").value=document.getElementById("googleLink").value,document.getElementById("update_website_link").value=document.getElementById("websiteLink").value,document.getElementById("update_establishment_type").value=document.getElementById("establishmentType").value,document.getElementById("update-image-file-name").innerHTML=document.getElementById("image-file-name").innerHTML,document.getElementById("updateimage").src=document.getElementById("image").src,$("select").formSelect(),M.updateTextFields();var t=Backendless.DataQueryBuilder.create();return t.setSortBy(["Name"]),t.setPageSize(100).setOffset(0),Backendless.Data.of("Cuisine").find(t).then(function(e){var t=document.getElementById("update_cusine_type");$("#update_cusine_type").empty();var n=1,a=0,d=e.length;for(a=0;a<d;a++)t.options[0]=new Option("Choose your cuisine type",""),t.options[0].disabled=!0,t.options[n]=new Option(e[a].Name,e[a].Name),n++}).then(()=>{var e=document.getElementById("cusineType").value.split(", ");$("#update_cusine_type").val(e),$("select").formSelect()}).catch(function(e){})}if("Special details"==document.getElementById("formHeading").innerHTML)if(""==document.getElementById("specialId").value)document.getElementById("updateBtn").setAttribute("href","#"),toastNotification("No establishment or special selected.","toast-error","error-symbol.png","red lighten-1","Infinity","#ce5548",0);else{document.getElementById("updateBtn").setAttribute("href","#modal2"),M.textareaAutoResize($("#update_description")),document.getElementById("updateHeading").innerHTML="Update special",document.getElementById("formUpdateEstablishmentDetails").style.display="none",document.getElementById("formUpdateSpecialDetails").style.display="block";var n=document.getElementById("daysOfWeek").value.split(", ");$("#update_days_of_the_week").val(n),document.getElementById("update_start_time").value=convertTo24Hour2("startTime"),document.getElementById("update_end_time").value=convertTo24Hour2("endTime"),document.getElementById("update_category").value=document.getElementById("category").value,document.getElementById("update_type_of_special").value=document.getElementById("typeOfSpecial").value,document.getElementById("update_description").value=document.getElementById("descriptionFullText").value,M.textareaAutoResize($("#update_description"))}}$("select").formSelect(),M.updateTextFields()}),updateConfirmBtn.addEventListener("click",e=>{if(e.preventDefault(),"Establishment details"==document.getElementById("formHeading").innerHTML){var t=document.getElementById("establishmentId").value.trim(),n=document.getElementById("update_name").value.trim(),a=document.getElementById("update_address").value.trim(),d=document.getElementById("update_suburb").value.trim(),s=document.getElementById("update_postcode").value.trim(),l=document.getElementById("update_country").value,i=document.getElementById("update_establishment_type").value,o=$("#update_cusine_type").val().join(", "),m=document.getElementById("update_google_link").value.trim(),c=document.getElementById("update_website_link").value.trim(),r=document.getElementById("updateFilesText").value,u=document.getElementById("chkBoxUpdateDefaultImg").checked;if(""==n||n.length>50||""==a||a.length>100||""!=a&&!a.match(/^[a-zA-Z0-9\/\-\& ]+$/)||""==d||d.length>50||""!=d&&!d.match(/^[A-Za-z ]+$/)||""==s||s.length>4||""!=s&&!s.match(/^[0-9]+$/)||""==l||""==o||m.length>100||c.length>100||"default.jpg"==r&&0==u){var g="";""==n&&(g+='"Name" is required!<br>'),n.length>50&&(g+='"Name" must not exceed 50 characters!<br>'),""==a&&(g+='"Address" is required!<br>'),a.length>100&&(g+='"Address" must not exceed 100 characters!<br>'),""==a||a.match(/^[a-zA-Z0-9\/\-\& ]+$/)||(g+='"Address" contains non-alphanumerical characters! Exception ("/", "-", "&").<br>'),""==d&&(g+='"Suburb" is required!<br>'),d.length>50&&(g+='"Suburb" must not exceed 50 characters!<br>'),""==d||d.match(/^[A-Za-z ]+$/)||(g+='"Suburb" contains non-alphabetic characters!<br>'),""==s&&(g+='"Postcode" is required!<br>'),s.length>4&&(g+='"Postcode" must not exceed 4 numbers!<br>'),""==s||s.match(/^[0-9]+$/)||(g+='"Postcode" contains non-numerical characters!<br>'),""==l&&(g+='"Country" is required!<br>'),""==o&&(g+='"Cuisine Type" is required!<br>'),m.length>100&&(g+='"Google Buisness Link" must not exceed 100 characters!<br>'),c.length>100&&(g+='"Website Link" must not exceed 100 characters!<br>'),"default.jpg"==r&&0==u&&(g+='"default.jpg" is a reserved filename!<br>'),toastNotification(g,"toast-error","error-symbol.png","red lighten-1","Infinity","#ce5548",0),e.preventDefault()}else if(document.getElementById("workingAnim").style.display="block",document.getElementById("h5workingAnimMessage").innerHTML="Updating",document.getElementById("h5workingAnimMessage").style.display="block",document.getElementById("address").value==a&&document.getElementById("suburb").value==d||""==document.getElementById("updateFiles").value&&1!=u){if(document.getElementById("address").value==a&&document.getElementById("suburb").value==d){if(""!=document.getElementById("updateFiles").value||1==u&&"default.jpg"!=document.getElementById("update-image-file-name").innerHTML){if(1==u){var y={Google_Business_Link:m,Website_Link:c,Image:h="https://backendlessappcontent.com/073669A8-CCB7-2AED-FFEC-841A4CE5F400/CCB6BFB7-82E5-4240-A911-5E169AEA70F2/files/images/default.jpg",objectId:t,Name:n,Address:a,Suburb:d,Postcode:s,Country:l,Establishment_Type:i,Cuisine_Type:o};return cellID=t,Backendless.Data.of("Establishment").save(y).then(function(e){}).then(()=>onPageLoadTable($("#tbl").scrollTop())).then(()=>{endAnimations()}).then(()=>{toastNotification("Establishment has been updated successfully!","toast-tick","white-check-mark.png","green",4e3,"#2d995b",375)}).then(()=>{var e=document.getElementById("update-image-file-name").innerHTML;if("default.jpg"!=e&&e!=document.getElementById("updateFilesText").value)return Backendless.Files.remove("images/"+e).then(function(){}).catch(function(e){})}).then(()=>{document.querySelector("#updatespecial-form").reset()}).then(()=>{enableUpdateCustomImage()}).catch(e=>{console.error(e)})}return file=document.getElementById("updateFiles").files[0],Backendless.Files.upload(file,"images",!0).then(function(e){h=e.fileURL}).then(()=>{var e={Google_Business_Link:m,Website_Link:c,Image:h,objectId:t,Name:n,Address:a,Suburb:d,Postcode:s,Country:l,Establishment_Type:i,Cuisine_Type:o};return cellID=t,Backendless.Data.of("Establishment").save(e).then(function(e){})}).then(()=>onPageLoadTable($("#tbl").scrollTop())).then(()=>{endAnimations()}).then(()=>{toastNotification("Establishment has been updated successfully!","toast-tick","white-check-mark.png","green",4e3,"#2d995b",375)}).then(()=>{var e=document.getElementById("update-image-file-name").innerHTML;if("default.jpg"!=e&&e!=document.getElementById("updateFilesText").value)return Backendless.Files.remove("images/"+e).then(function(){}).catch(function(e){console.log("error - "+e.message)})}).then(()=>{document.querySelector("#updatespecial-form").reset()}).catch(e=>{console.error(e)})}if(document.getElementById("name").value!=document.getElementById("update_name").value||document.getElementById("postcode").value!=document.getElementById("update_postcode").value||document.getElementById("country").value!=document.getElementById("update_country").value||document.getElementById("establishmentType").value!=document.getElementById("update_establishment_type").value||document.getElementById("cusineType").value!=document.getElementById("update_cusine_type").value||document.getElementById("googleLink").value!=document.getElementById("update_google_link").value||document.getElementById("websiteLink").value!=document.getElementById("update_website_link").value){y={Google_Business_Link:m,Website_Link:c,objectId:t,Name:n,Address:a,Suburb:d,Postcode:s,Country:l,Establishment_Type:i,Cuisine_Type:o};return Backendless.Data.of("Establishment").save(y).then(function(e){}).catch(function(e){console.log("an error has occurred "+e.message)}).then(()=>onPageLoadTable($("#tbl").scrollTop())).then(()=>{endAnimations()}).then(()=>{toastNotification("Establishment has been updated successfully!","toast-tick","white-check-mark.png","green",4e3,"#2d995b",375)}).catch(e=>{console.error(e)})}return endAnimations(),document.querySelector("#updatespecial-form").reset(),void enableUpdateCustomImage()}E=a+" "+d,B=[];axios.get("https://maps.googleapis.com/maps/api/geocode/json?components=country:NZ|country:AU",{params:{address:E,key:"AIzaSyBmpzz0lX4w2UV3KXivbLrQ3AHJUvOzbOI"}}).then(function(e){return p=e.data.results[0].geometry.location.lat,b=e.data.results[0].geometry.location.lng,B.push(p),B.push(b),B}).then(()=>{var e={Google_Business_Link:m,Website_Link:c,Location:(new Backendless.Data.Point).setLatitude(B[0]).setLongitude(B[1]),objectId:t,Name:n,Address:a,Suburb:d,Postcode:s,Country:l,Establishment_Type:i,Cuisine_Type:o};return Backendless.Data.of("Establishment").save(e).then(function(e){}).catch(function(e){console.log("an error has occurred "+e.message)})}).then(()=>onPageLoadTable($("#tbl").scrollTop())).then(()=>{document.getElementById("workingAnim").style.display="none"}).then(()=>{document.getElementById("h5workingAnimMessage").style.display="none"}).then(()=>{toastNotification("Establishment has been updated successfully!","toast-tick","white-check-mark.png","green",4e3,"#2d995b",375)}).then(()=>{document.getElementById("name").value=document.getElementById("update_name").value,document.getElementById("address").value=document.getElementById("update_address").value,document.getElementById("suburb").value=document.getElementById("update_suburb").value,document.getElementById("country").value=document.getElementById("update_country").value,document.getElementById("establishmentType").value=document.getElementById("update_establishment_type").value,document.getElementById("cusineType").value=document.getElementById("update_cusine_type").value}).catch(e=>{"TypeError: Cannot read property 'geometry' of undefined"==e&&(toastNotification("An error was encountered while handling the request. The address and/or suburb was unable to be identified.","toast-error","error-symbol.png","red lighten-1","Infinity","#ce5548",0),endAnimations(),console.error(e))})}else{var h;console.log("Address and file changed");var p,b,E=a+" "+d,B=[];axios.get("https://maps.googleapis.com/maps/api/geocode/json?components=country:NZ|country:AU",{params:{address:E,key:"AIzaSyBmpzz0lX4w2UV3KXivbLrQ3AHJUvOzbOI"}}).then(function(e){return p=e.data.results[0].geometry.location.lat,b=e.data.results[0].geometry.location.lng,B.push(p),B.push(b),B}).then(()=>{if(1!=u)return file=document.getElementById("updateFiles").files[0],Backendless.Files.upload(file,"images",!0).then(function(e){h=e.fileURL});h="https://backendlessappcontent.com/073669A8-CCB7-2AED-FFEC-841A4CE5F400/CCB6BFB7-82E5-4240-A911-5E169AEA70F2/files/images/default.jpg"}).then(()=>{var e={Google_Business_Link:m,Website_Link:c,Image:h,Location:(new Backendless.Data.Point).setLatitude(B[0]).setLongitude(B[1]),objectId:t,Name:n,Address:a,Suburb:d,Postcode:s,Country:l,Establishment_Type:i,Cuisine_Type:o};return Backendless.Data.of("Establishment").save(e).then(function(e){}).catch(function(e){})}).then(()=>onPageLoadTable($("#tbl").scrollTop())).then(()=>{document.getElementById("workingAnim").style.display="none"}).then(()=>{document.getElementById("h5workingAnimMessage").style.display="none"}).then(()=>{toastNotification("Establishment has been updated successfully!","toast-tick","white-check-mark.png","green",4e3,"#2d995b",375)}).then(()=>{document.getElementById("name").value=document.getElementById("update_name").value,document.getElementById("address").value=document.getElementById("update_address").value,document.getElementById("suburb").value=document.getElementById("update_suburb").value,document.getElementById("country").value=document.getElementById("update_country").value,document.getElementById("establishmentType").value=document.getElementById("update_establishment_type").value,document.getElementById("cusineType").value=document.getElementById("update_cusine_type").value}).then(()=>{var e=document.getElementById("update-image-file-name").innerHTML;if("default.jpg"!=e&&e!=document.getElementById("updateFilesText").value)return Backendless.Files.remove("images/"+e).then(function(){}).catch(function(e){console.log("error - "+e.message)})}).then(()=>{document.querySelector("#updatespecial-form").reset()}).then(()=>{enableUpdateCustomImage()}).catch(e=>{"TypeError: Cannot read property 'geometry' of undefined"==e&&(toastNotification("An error was encountered while handling the request. The address and/or suburb was unable to be identified.","toast-error","error-symbol.png","red lighten-1","Infinity","#ce5548",0),endAnimations(),console.error(e))})}}else if("Special details"==document.getElementById("formHeading").innerHTML){var I=document.getElementById("specialId").value,f=$("#update_days_of_the_week").val().join(", "),v=document.getElementById("update_start_time").value,_=document.getElementById("update_end_time").value,k=document.getElementById("update_category").value,T=document.getElementById("update_type_of_special").value,A=document.getElementById("update_description").value;if(!(""==f||""==v||""==_||""==k||""==T||""==A||A.length>500)){document.getElementById("workingAnim").style.display="block",document.getElementById("h5workingAnimMessage").innerHTML="Updating",document.getElementById("h5workingAnimMessage").style.display="block";var S={objectId:I,Days_Of_Week:f,Start_Time:v,End_Time:_,Category:k,Type_Of_Special:T,Description:A};return Backendless.Data.of("Special").save(S).then(function(e){}).catch(function(e){console.log("an error has occurred "+e.message)}).then(()=>onPageLoadTable()).then(()=>{endAnimations()}).then(()=>{toastNotification("Special has been updated successfully!","toast-tick","white-check-mark.png","green",4e3,"#2d995b",375)}).then(()=>{document.getElementById("startTime").value=tConvert(document.getElementById("update_start_time").value),document.getElementById("endTime").value=tConvert(document.getElementById("update_end_time").value),document.getElementById("category").value=document.getElementById("update_category").value,document.getElementById("typeOfSpecial").value=document.getElementById("update_type_of_special").value,document.getElementById("description").value=document.getElementById("update_description").value}).catch(e=>{console.error(e)})}g="";""==f&&(g+='"Days of the week" is required!<br>'),""==v&&(g+='"Start time" is required!<br>'),""==_&&(g+='"End time" is required!<br>'),""==k&&(g+='"Category" is required!<br>'),""==T&&(g+='"Type of special" is required!<br>'),""==A&&(g+='"Description" is required!<br>'),A.length>500&&(g+='"Description" must be less than 500 characters!<br>'),toastNotification(g,"toast-error","error-symbol.png","red lighten-1","Infinity","#ce5548",0)}}),updateCancelBtn.addEventListener("click",e=>{e.preventDefault(),updateForm=document.querySelector("#updatespecial-form"),updateForm.reset(),enableUpdateCustomImage()}),deleteBtn.addEventListener("click",e=>{e.preventDefault(),M.Toast.dismissAll(),""==document.getElementById("establishmentId").value?(document.getElementById("deleteBtn").setAttribute("href","#"),toastNotification("No establishment or special selected.","toast-error","error-symbol.png","red lighten-1","Infinity","#ce5548",0)):"Establishment details"==document.getElementById("formHeading").innerHTML?(document.getElementById("deleteBtn").setAttribute("href","#modalDeleteCancelConfirm"),document.getElementById("deleteConfirmHeading").innerHTML="Delete establishment",document.getElementById("establishmentToDelete").innerHTML="Do you want to delete the selected Establishment?<br><br><b>"+document.getElementById("name").value+"</b>"):"Special details"==document.getElementById("formHeading").innerHTML&&(""==document.getElementById("specialId").value?(document.getElementById("deleteBtn").setAttribute("href","#"),toastNotification("No establishment or special selected.","toast-error","error-symbol.png","red lighten-1","Infinity","#ce5548",0)):(document.getElementById("deleteBtn").setAttribute("href","#modalDeleteCancelConfirm"),document.getElementById("establishmentToDelete").innerHTML="Do you want to delete <b>"+document.getElementById("name").value+"'s </b>"+document.getElementById("category").value+'?<br><br>"'+document.getElementById("description").value+'"',document.getElementById("deleteConfirmHeading").innerHTML="Delete special"))}),deleteCancelConfirmDeleteBtn.addEventListener("click",e=>{if(e.preventDefault(),"Establishment details"==document.getElementById("formHeading").innerHTML){for(var t=document.getElementById("establishmentId").value,n=0;n<masterEstablishments.length;n++)if(masterEstablishments[n].objectId==t){if(!(masterEstablishments[n].establishmentSpecials.length>0)){document.getElementById("workingAnim").style.display="block",document.getElementById("h5workingAnimMessage").innerHTML="Deleting",document.getElementById("h5workingAnimMessage").style.display="block";var a=/[^\/]*$/.exec(masterEstablishments[n].Image)[0];return"default.jpg"!=a&&Backendless.Files.remove("images/"+a).then(function(){}).catch(function(e){console.log("error - "+e.message)}),Backendless.Data.of("Establishment").remove({objectId:t}).then(function(e){}).catch(function(e){console.log("an error has occurred "+e.message)}).then(()=>{onPageLoadTable()}).then(()=>{$("#specialListBox").empty(),displayEstablishmentandSpecialForm=document.querySelector("#displayEstablishmentandSpecial-form"),displayEstablishmentandSpecialForm.reset(),document.getElementById("addToExistingEstablishment").value="",document.getElementById("image-file-name").innerHTML=""}).then(()=>{endAnimations()}).then(()=>{toastNotification("Establishment has been deleted successfully!","toast-tick","white-check-mark.png","light-blue darken-2",4e3,"#0277bd",375)}).catch(e=>{console.error(e)})}toastNotification("The establishment must contain no specials in order to delete.","toast-error","error-symbol.png","red lighten-1","Infinity","#ce5548",0)}}else if("Special details"==document.getElementById("formHeading").innerHTML){var d=document.getElementById("specialId").value;return Backendless.Data.of("Special").remove({objectId:d}).then(function(e){}).catch(function(e){console.log("an error has occurred "+e.message)}).then(()=>{$("#specialListBox option:selected").remove(),displayEstablishmentandSpecialForm=document.querySelector("#displayEstablishmentandSpecial-form"),displayEstablishmentandSpecialForm.reset()}).then(()=>{onPageLoadTable()}).then(()=>{endAnimations()}).then(()=>{toastNotification("Special has been deleted successfully!","toast-tick","white-check-mark.png","light-blue darken-2",4e3,"#0277bd",375)}).catch(e=>{console.error(e)})}}),jQuery(".white-text").click(function(e){jQuery(".selected-sidenav").removeClass("selected-sidenav"),jQuery(this).addClass("selected-sidenav")});const image=document.getElementById("image-cropper");var cropper=new Cropper(image,{viewMode:1,minCropBoxWidth:545,minCropBoxHeight:120}),loadFile=function(e){cropper.replace(URL.createObjectURL(e.target.files[0]));var t=new Image;t.onload=function(){var e="";120==this.height&&545==this.width&&(e+="Image dimensions are perfect! (W:545 x H:120)"),this.height>120&&(e+="Image height too large ("+this.height+" pixels) - Please crop image to defined sizing (W:545 x H:120)<br>"),this.height<120&&(e+="Image height too small ("+this.height+" pixels) - Please increase orignal size to avoid distortions (W:545 x H:120)<br>"),this.width>545&&(e+="Image width too large ("+this.width+" pixels) -  Please crop image to defined sizing (W:545 x H:120)<br>"),this.width<545&&(e+="Image width too small ("+this.width+" pixels) - Please increase orignal size to avoid distortions (W:545 x H:120)<br>"),document.getElementById("imageCropperError").innerHTML="<br>"+e+"<br><br>"},t.src=URL.createObjectURL(e.target.files[0])};