Backendless.serverURL="https://api.backendless.com",Backendless.initApp("073669A8-CCB7-2AED-FFEC-841A4CE5F400","FAFDE171-5308-49CF-9980-AA89E4F28F0C");var suburb=localStorage.getItem("usersSuburb"),initialSearch=!0,_typeOfSpecial=["Drink"],masterEstablishments=[],masterMarkers=[],filteredMarkers=[],useFilteredMarkers=!1,lat=0,lng=0,state="filtered-list";function pageOnLoad(){if(!initialSearch){useFilteredMarkers=!1,$("#daysOfWeekFilter").val("");var e=document.getElementById("daysOfWeekFilter");e.options[0]=new Option("Any",""),e.options[0].disabled=!0,document.getElementById("timePeriodStartFilter").selectedIndex="0",document.getElementById("timePeriodEndFilter").selectedIndex="16",$("#specialCategoryFilter").val("");var t=document.getElementById("specialCategoryFilter");t.options[0]=new Option("Any",""),t.options[0].disabled=!0;a=0;var s=Backendless.DataQueryBuilder.create();return s.setRelated(["establishmentSpecials"]),s.setWhereClause("Suburb = '"+suburb+"'"),Backendless.Data.of("Establishment").find(s).then(function(e){document.getElementById("rpList").innerHTML="";for(var t=["Drink"],s=e.reduce((e,s)=>{const l=s.establishmentSpecials.filter(e=>t.includes(e.Type_Of_Special));return l.length>0?[...e,{...s,establishmentSpecials:l}]:e},[]),l=0;l<s.length;l++)if(s[l].establishmentSpecials.length>0){sortEstablishmentSpecials(s,l),document.getElementById("rpList").innerHTML+='<div class="establishment-wrapper"  data-id="'+s[l].objectId+'" id="viewEstablishmentPage"><img class="rpImage" src="'+s[l].Image+'"><br><span class="est-name">'+s[l].Name+'</span><hr class="est-name-underline"></div>',document.getElementById("rpList").innerHTML+='<div class="tbl-wrapper" ><table id=\'tbl\'  class="striped"><colgroup><col span="1" class="tbl-special"><col span="1" class="tbl-days"></colgroup><tbody id="myTable'+s[l].objectId+'"></tbody></table></div>';for(var i=0;i<s[l].establishmentSpecials.length;i++){var n=document.getElementById("myTable"+s[l].objectId);addRowTopSpecial(n,'<img class="cocktail-small-img" src="images/cocktail-yellow.png">'+s[l].establishmentSpecials[i].Description,s[l].establishmentSpecials[i].objectId),addRowBottom(n,'<img class="time-img" src="images/clock-small.png"><div class="time-period">'+tConvert(s[l].establishmentSpecials[i].Start_Time)+" - "+tConvert(s[l].establishmentSpecials[i].End_Time)+"</div>",'<img class="calander-img" src="images/calander-small.png"><div class="daysAbbreviated">'+daysAbbreviated(s,l,i)+"</div>",s[l].establishmentSpecials[i].objectId),a++}document.getElementById("rpList").innerHTML+='<div class="est-line-break"></div>'}var r=document.getElementById("cusineTypeFilter");$("#cusineTypeFilter").empty();var o=[],d=0,c=e.length,m=0;for(d=0;d<c;d++){var p=!1;for(m=0;m<e[d].establishmentSpecials.length;m++)if("Food"==e[d].establishmentSpecials[m].Type_Of_Special){p=!0;break}if(1==p){if(e[d].Cuisine_Type.includes(", "))for(var b=e[d].Cuisine_Type.split(", "),g=0,u=b.length;g<u;g++)o.push(b[g]);else o.push(e[d].Cuisine_Type);0}}var y=o.filter(onlyUnique);y.sort();var h,f=1,S=0,k=y.length;for(S=0;S<k;S++)r.options[0]=new Option("Any",""),r.options[0].disabled=!0,r.options[f]=new Option(y[S],y[S]),f++;drinkFoodVisuals("drink"),_typeOfSpecial=["Drink"],masterEstablishments=e,document.getElementById("rpNumOfSpecialsFound").innerHTML="Found '"+a+"' matching Drink specials",h=e.length>0?e[0].Postcode:"No results",document.getElementById("displaySuburb").innerHTML='<span class="display-suburb">'+suburb+", "+h+"</span>","block"==document.getElementById("rpGoogleMap").style.display&&(document.getElementById("rpGoogleMap").style.display="none",document.getElementById("rpList").style.display="block",document.getElementById("rpbtnList").style.backgroundColor="#E63594",document.getElementById("rpBtnMap").style.backgroundColor="#d9d9d9"),document.getElementById("cusineTypeFilter").disabled=!0,$("select").formSelect(),document.getElementById("backArrow").style.display="none",console.log("1. Populate list")}).then(()=>{var e,t=suburb;return e=null!=masterEstablishments[0]?"https://maps.googleapis.com/maps/api/geocode/json?components=country:"+masterEstablishments[0].Country:"https://maps.googleapis.com/maps/api/geocode/json?components=country:NZ|country:AU",axios.get(e,{params:{address:t,key:"AIzaSyBmpzz0lX4w2UV3KXivbLrQ3AHJUvOzbOI"}}).then(function(e){lat=e.data.results[0].geometry.location.lat,lng=e.data.results[0].geometry.location.lng,console.log("2. Get suburb coords")}).then(()=>{console.log("3. Start map markers creation");for(var e=0;e<masterEstablishments.length;e++)if(masterEstablishments[e].establishmentSpecials.length>0){console.log("4.1 Start creating a single marker");masterMarkers.push({coords:{lat:masterEstablishments[e].Location.y,lng:masterEstablishments[e].Location.x},iconImage:"images/restaurant.png",content:masterEstablishments[e].Name+"<br>"+masterEstablishments[e].Cuisine_Type+"<br>"+masterEstablishments[e].Address+"<br>",Name:masterEstablishments[e].Name,Address:masterEstablishments[e].Address,Cuisine_Type:masterEstablishments[e].Cuisine_Type,establishmentSpecials:masterEstablishments[e].establishmentSpecials,objectId:masterEstablishments[e].objectId}),console.log("4.2 Finish creating a single marker")}console.log("5. Finish map markers creation")}).then(()=>{console.log("6. Initialize map")})}).catch(function(e){})}var l=sessionStorage.getItem("suburbResults");l=JSON.parse(l),document.getElementById("rpList").innerHTML="";for(var a=0,i=["Drink"],n=l.reduce((e,t)=>{const s=t.establishmentSpecials.filter(e=>i.includes(e.Type_Of_Special));return s.length>0?[...e,{...t,establishmentSpecials:s}]:e},[]),r=0;r<n.length;r++)if(n[r].establishmentSpecials.length>0){sortEstablishmentSpecials(n,r),document.getElementById("rpList").innerHTML+='<div class="establishment-wrapper"  data-id="'+n[r].objectId+'" id="viewEstablishmentPage"><img class="rpImage" src="'+n[r].Image+'"><br><span class="est-name">'+n[r].Name+'</span><hr class="est-name-underline"></div>',document.getElementById("rpList").innerHTML+='<div class="tbl-wrapper" ><table id=\'tbl\' class="striped"><colgroup><col span="1" class="tbl-special"><col span="1" class="tbl-days"></colgroup><tbody id="myTable'+n[r].objectId+'"></tbody></table></div>';for(var o=0;o<n[r].establishmentSpecials.length;o++){var d=document.getElementById("myTable"+n[r].objectId);addRowTopSpecial(d,'<img class="cocktail-small-img" src="images/cocktail-yellow.png">'+n[r].establishmentSpecials[o].Description,n[r].establishmentSpecials[o].objectId),addRowBottom(d,'<img class="time-img" src="images/clock-small.png"><div class="time-period">'+tConvert(n[r].establishmentSpecials[o].Start_Time)+" - "+tConvert(n[r].establishmentSpecials[o].End_Time)+"</div>",'<img class="calander-img" src="images/calander-small.png"><div class="daysAbbreviated">'+daysAbbreviated(n,r,o)+"</div>",n[r].establishmentSpecials[o].objectId),a++}document.getElementById("rpList").innerHTML+='<div class="est-line-break"></div>'}var c=document.getElementById("cusineTypeFilter");$("#cusineTypeFilter").empty();var m=[],p=0,b=l.length,g=0;for(p=0;p<b;p++){var u=!1;for(g=0;g<l[p].establishmentSpecials.length;g++)if("Food"==l[p].establishmentSpecials[g].Type_Of_Special){u=!0;break}if(1==u){if(l[p].Cuisine_Type.includes(", "))for(var y=l[p].Cuisine_Type.split(", "),h=0,f=y.length;h<f;h++)m.push(y[h]);else m.push(l[p].Cuisine_Type);0}}var S=m.filter(onlyUnique);S.sort();var k,E=1,v=0,I=S.length;for(v=0;v<I;v++)c.options[0]=new Option("Any",""),c.options[0].disabled=!0,c.options[E]=new Option(S[v],S[v]),E++;masterEstablishments=l,k=n.length>0?n[0].Postcode:"No results",document.getElementById("displaySuburb").innerHTML='<span class="display-suburb">'+suburb+", "+k+"</span>",console.log("1. Populate list"),document.getElementById("rpNumOfSpecialsFound").innerHTML="Found '"+a+"' matching Drink specials",document.getElementById("rpbtnList").style.backgroundColor="#E63594";var T=document.querySelectorAll("select");if(M.FormSelect.init(T),console.log("State: "+state),initialSearch){var B,_=suburb;return B=null!=masterEstablishments[0]?"https://maps.googleapis.com/maps/api/geocode/json?components=country:"+masterEstablishments[0].Country:"https://maps.googleapis.com/maps/api/geocode/json?components=country:NZ|country:AU",axios.get(B,{params:{address:_,key:"AIzaSyBmpzz0lX4w2UV3KXivbLrQ3AHJUvOzbOI"}}).then(function(e){lat=e.data.results[0].geometry.location.lat,lng=e.data.results[0].geometry.location.lng,console.log("2. Get suburb coords")}).then(()=>{console.log("3. Start map markers creation");for(var e=0;e<masterEstablishments.length;e++){if(masterEstablishments[e].establishmentSpecials.length>0){var t,s=0,l=masterEstablishments[e].establishmentSpecials.length;for(s=0;s<l;s++)"Drink"==masterEstablishments[e].establishmentSpecials[s].Type_Of_Special&&(t+=masterEstablishments[e].establishmentSpecials[s].Description+"<br>");console.log("4.1 Start creating a single marker");masterMarkers.push({coords:{lat:masterEstablishments[e].Location.coordinates[1],lng:masterEstablishments[e].Location.coordinates[0]},iconImage:"images/restaurant.png",content:masterEstablishments[e].Name+"<br>"+masterEstablishments[e].Cuisine_Type+"<br>"+masterEstablishments[e].Address+"<br>"+t,Name:masterEstablishments[e].Name,Address:masterEstablishments[e].Address,Cuisine_Type:masterEstablishments[e].Cuisine_Type,establishmentSpecials:masterEstablishments[e].establishmentSpecials,objectId:masterEstablishments[e].objectId}),console.log("4.2 Finish creating a single marker")}t=""}console.log("5. Finish map markers creation")}).catch(function(e){}).then(()=>{console.log("6. Initialize map")})}}function initMap(){console.log("7. Map Initialization started");var e={zoom:13,center:{lat:lat,lng:lng}};console.log("8. Start print markers"),console.log("9. End print markers");var t,s=new google.maps.Map(document.getElementById("rpGoogleMap"),e);if(console.log("Running first time"),console.log("10. Map created"),console.log("10.1 clear markers"),0==useFilteredMarkers)for(var l=0;l<masterMarkers.length;l++)a(masterMarkers[l]);else for(l=0;l<filteredMarkers.length;l++)a(filteredMarkers[l]);function a(e){var l=new google.maps.Marker({position:e.coords,map:s,Name:e.Name,Address:e.Address,Cuisine_Type:e.Cusine_Type,establishmentSpecials:e.establishmentSpecials,objectId:e.objectId});if(e.iconImage&&l.setIcon(e.iconImage),e.content){var a=new google.maps.InfoWindow({content:e.content});l.addListener("click",function(){t&&t.close(),a.open(s,l),t=a})}}console.log("11. Markers added")}function setMapOnAll(e){for(var t=0;t<filteredMarkers.length;t++)filteredMarkers[t].setMap(e)}function clearMarkers(){setMapOnAll(null),filteredMarkers=[]}function deleteMarkers(){for(var e=0;e<filteredMarkers.length;e++)filteredMarkers[e].setMap(null);filteredMarkers=[]}function daysOfWeekFilter(){document.getElementById("rpGoogleMap").style.display="none",document.getElementById("rpList").style.display="block",state="filtered-list",console.log("State: "+state),applyFilters(),document.getElementById("backArrow").style.display="none"}function timePeriodFilter(){document.getElementById("rpGoogleMap").style.display="none",document.getElementById("rpList").style.display="block",state="filtered-list",console.log("State: "+state),applyFilters(),document.getElementById("backArrow").style.display="none"}function specialCategoryFilter(){document.getElementById("rpGoogleMap").style.display="none",document.getElementById("rpList").style.display="block",state="filtered-list",console.log("State: "+state),applyFilters(),document.getElementById("backArrow").style.display="none"}function cusineTypeFilter(){document.getElementById("rpGoogleMap").style.display="none",document.getElementById("rpList").style.display="block",state="filtered-list",console.log("State: "+state),applyFilters(),document.getElementById("backArrow").style.display="none"}function establishmentTypeFilter(){state="filtered-list",console.log("State: "+state),applyFilters()}function typeOfSpecialFilterDrink(){drinkFoodVisuals("drink"),document.getElementById("rpGoogleMap").style.display="none",document.getElementById("rpList").style.display="block",document.getElementById("cusineTypeFilter").disabled=!0,$("select").formSelect(),_typeOfSpecial=["Drink"],state="filtered-list",console.log("State: "+state),applyFilters(),document.getElementById("backArrow").style.display="none"}function typeOfSpecialFilterFood(){drinkFoodVisuals("food"),document.getElementById("rpGoogleMap").style.display="none",document.getElementById("rpList").style.display="block",document.getElementById("cusineTypeFilter").disabled=!1,$("select").formSelect(),_typeOfSpecial=["Food"],state="filtered-list",console.log("State: "+state),applyFilters(),document.getElementById("backArrow").style.display="none"}function applyFilters(){for(var e=$("#daysOfWeekFilter").val(),t=$("#timePeriodStartFilter").val(),s=$("#timePeriodEndFilter").val(),l=$("#specialCategoryFilter").val(),a=$("#cusineTypeFilter").val(),i=_typeOfSpecial,n=masterEstablishments,r=[],o=0;o<n.length;o++)for(var d=0;d<n[o].establishmentSpecials.length;d++){var c=[];if(n[o].establishmentSpecials[d].Days_Of_Week.includes(", "))for(var m=n[o].establishmentSpecials[d].Days_Of_Week.split(", "),p=0,b=m.length;p<b;p++)c.push(m[p]);else c.push(n[o].establishmentSpecials[d].Days_Of_Week);for(var g=0;g<e.length;g++)1==c.includes(e[g])&&r.push(n[o].establishmentSpecials[d].objectId)}e.length>=1&&r.length>=0&&(n=n.reduce((e,t)=>{const s=t.establishmentSpecials.filter(e=>r.includes(e.objectId));return s.length>0?[...e,{...t,establishmentSpecials:s}]:e},[]));var u=60*t.substring(0,2)+ +t.substring(3,5),y=60*s.substring(0,2)+ +s.substring(3,5),h=[];for(o=0;o<n.length;o++)for(d=0;d<n[o].establishmentSpecials.length;d++){var f=n[o].establishmentSpecials[d].Start_Time,S=n[o].establishmentSpecials[d].End_Time;f=60*f.substring(0,2)+ +f.substring(3,5),(S=60*S.substring(0,2)+ +S.substring(3,5))>u&&f<y&&u<y&&h.push(n[o].establishmentSpecials[d].objectId)}if(h.length>=0&&(n=n.reduce((e,t)=>{const s=t.establishmentSpecials.filter(e=>h.includes(e.objectId));return s.length>0?[...e,{...t,establishmentSpecials:s}]:e},[])),l.length>=1&&(n=n.reduce((e,t)=>{const s=t.establishmentSpecials.filter(e=>l.includes(e.Category));return s.length>0?[...e,{...t,establishmentSpecials:s}]:e},[])),"Food"==_typeOfSpecial[0]){var k=[];for(o=0;o<n.length;o++){var E=[];if(n[o].Cuisine_Type.includes(", ")){var v=n[o].Cuisine_Type.split(", ");for(p=0,b=v.length;p<b;p++)E.push(v[p])}else E.push(n[o].Cuisine_Type);for(g=0;g<a.length;g++)1==E.includes(a[g])&&k.push(n[o].objectId)}a.length>=1&&(n=n.filter(e=>k.includes(e.objectId)))}i.length>=1&&(n=n.reduce((e,t)=>{const s=t.establishmentSpecials.filter(e=>i.includes(e.Type_Of_Special));return s.length>0?[...e,{...t,establishmentSpecials:s}]:e},[]));var I=0;if("establishment-page-map"!=state){document.getElementById("rpList").innerHTML="";for(o=0;o<n.length;o++){sortEstablishmentSpecials(n,o),document.getElementById("rpList").innerHTML+='<div class="establishment-wrapper"  data-id="'+n[o].objectId+'" id="viewEstablishmentPage"><img class="rpImage" src="'+n[o].Image+'"><br><span class="est-name">'+n[o].Name+'</span><hr class="est-name-underline"></div>',document.getElementById("rpList").innerHTML+='<div class="tbl-wrapper" ><table id=\'tbl\' class="striped"><colgroup><col span="1" class="tbl-special"><col span="1" class="tbl-days"></colgroup><tbody id="myTable'+n[o].objectId+'"></tbody></table></div>';for(d=0;d<n[o].establishmentSpecials.length;d++){var M=document.getElementById("myTable"+n[o].objectId);addRowTopSpecial(M,("Drink"==_typeOfSpecial[0]?'<img class="cocktail-small-img" src="images/cocktail-yellow.png">':'<img class="hamburger-small-img" src="images/burger-black.png">')+n[o].establishmentSpecials[d].Description,n[o].establishmentSpecials[d].objectId),addRowBottom(M,'<img class="time-img" src="images/clock-small.png"><div class="time-period">'+tConvert(n[o].establishmentSpecials[d].Start_Time)+" - "+tConvert(n[o].establishmentSpecials[d].End_Time)+"</div>",'<img class="calander-img" src="images/calander-small.png"><div class="daysAbbreviated">'+daysAbbreviated(n,o,d)+"</div>",n[o].establishmentSpecials[d].objectId),I++}document.getElementById("rpList").innerHTML+='<div class="est-line-break"></div>'}document.getElementById("rpNumOfSpecialsFound").innerHTML="Found '"+I+"' matching "+_typeOfSpecial[0]+" specials"}if("block"==document.getElementById("rpGoogleMap").style.display){console.log("Map displayed"),useFilteredMarkers=!0,filteredMarkers=masterMarkers;var T=[];for(o=0;o<filteredMarkers.length;o++)for(d=0;d<filteredMarkers[o].establishmentSpecials.length;d++){var B=[];if(filteredMarkers[o].establishmentSpecials[d].Days_Of_Week.includes(", ")){var _=filteredMarkers[o].establishmentSpecials[d].Days_Of_Week.split(", ");for(p=0,b=_.length;p<b;p++)B.push(_[p])}else B.push(filteredMarkers[o].establishmentSpecials[d].Days_Of_Week);for(g=0;g<e.length;g++)1==B.includes(e[g])&&T.push(filteredMarkers[o].establishmentSpecials[d].objectId)}e.length>=1&&T.length>=0&&(filteredMarkers=filteredMarkers.reduce((e,t)=>{const s=t.establishmentSpecials.filter(e=>T.includes(e.objectId));return s.length>0?[...e,{...t,establishmentSpecials:s}]:e},[]));var C=60*t.substring(0,2)+ +t.substring(3,5),F=60*s.substring(0,2)+ +s.substring(3,5),L=[];for(o=0;o<filteredMarkers.length;o++)for(d=0;d<filteredMarkers[o].establishmentSpecials.length;d++){var w=filteredMarkers[o].establishmentSpecials[d].Start_Time,O=filteredMarkers[o].establishmentSpecials[d].End_Time;w=60*w.substring(0,2)+ +w.substring(3,5),(O=60*O.substring(0,2)+ +O.substring(3,5))>C&&w<F&&L.push(filteredMarkers[o].establishmentSpecials[d].objectId)}if(L.length>=0&&(filteredMarkers=filteredMarkers.reduce((e,t)=>{const s=t.establishmentSpecials.filter(e=>L.includes(e.objectId));return s.length>0?[...e,{...t,establishmentSpecials:s}]:e},[])),l.length>=1&&(filteredMarkers=filteredMarkers.reduce((e,t)=>{const s=t.establishmentSpecials.filter(e=>l.includes(e.Category));return s.length>0?[...e,{...t,establishmentSpecials:s}]:e},[])),"Food"==_typeOfSpecial[0]){var A=[];for(o=0;o<filteredMarkers.length;o++){var j=[];if(filteredMarkers[o].Cuisine_Type.includes(", ")){var D=filteredMarkers[o].Cuisine_Type.split(", ");for(p=0,b=D.length;p<b;p++)j.push(D[p])}else j.push(filteredMarkers[o].Cuisine_Type);for(g=0;g<a.length;g++)1==j.includes(a[g])&&A.push(filteredMarkers[o].objectId)}a.length>=1&&(filteredMarkers=filteredMarkers.filter(e=>A.includes(e.objectId)))}i.length>=1&&(filteredMarkers=filteredMarkers.reduce((e,t)=>{const s=t.establishmentSpecials.filter(e=>i.includes(e.Type_Of_Special));return s.length>0?[...e,{...t,establishmentSpecials:s}]:e},[]));var H=0,N=filteredMarkers.length;for(H=0;H<N;H++){var R="<b>"+filteredMarkers[H].Name+"</b><br>"+filteredMarkers[H].Cuisine_Type+"<br>"+filteredMarkers[H].Address+"<br><br>";sortEstablishmentSpecials(filteredMarkers,H);var W="",G=0,P=filteredMarkers[H].establishmentSpecials.length;for(G=0;G<P;G++)W+=filteredMarkers[H].establishmentSpecials[G].Description+"<br>"+tConvert(filteredMarkers[H].establishmentSpecials[G].Start_Time)+" - "+tConvert(filteredMarkers[H].establishmentSpecials[G].End_Time)+'<br><span class="dowMarker">'+daysAbbreviated(filteredMarkers,H,G)+"</span><br><br>";filteredMarkers[H].content=R+W}if("establishment-page-map"==state){console.log("State: Display establishment map marker");var z=function(e,t,s){for(var l=0,a=null;l<s&&-1!==a;)a=e.indexOf(t,a+1),l++;return a}((filteredMarkers=filteredMarkers.filter(e=>e.content.includes(document.getElementById("rpNumOfSpecialsFound").innerHTML)))[0].content,"<br>",3);filteredMarkers[0].content=[filteredMarkers[0].content.slice(0,z),"<br><br><b><i>Specials matching your search criteria</i></b>",filteredMarkers[0].content.slice(z)].join("");for(var U=[],x=0,V=filteredMarkers[0].establishmentSpecials.length;x<V;x++)U.push(filteredMarkers[0].establishmentSpecials[x].objectId);var q=masterMarkers,X=(q=q.filter(e=>e.content.includes(document.getElementById("rpNumOfSpecialsFound").innerHTML)))[0].establishmentSpecials.filter(e=>!U.includes(e.objectId));sortSpecials(X);var J="",Q=0,K=X.length;if(K>0){for(;Q<K;Q++)J+=X[Q].Description+"<br>"+tConvert(X[Q].Start_Time)+" - "+tConvert(X[Q].End_Time)+'<br><span class="dowMarker">'+daysAbbreviated(X,void 0,Q)+"</span><br><br>";filteredMarkers[0].content+="<b><i>Other specials on offer</i></b><br><br>"+J}}initMap()}document.getElementById("rpbtnList").style.backgroundColor="#E63594",document.getElementById("rpBtnMap").style.backgroundColor="#d9d9d9"}function btnShowList(){document.getElementById("rpGoogleMap").style.display="none",document.getElementById("rpList").style.display="block","Drink"!=_typeOfSpecial[0]&&(document.getElementById("cusineTypeFilter").disabled=!1,$("select").formSelect()),"establishment-page-map"==state?(state="establishment-page",console.log("State: "+state)):"establishment-page"==state?(state="filtered-list",console.log("State: "+state),applyFilters(),document.getElementById("backArrow").style.display="none"):"filtered-list-map"==state&&(state="filtered-list",document.getElementById("backArrow").style.display="none",console.log("State: "+state)),document.getElementById("rpbtnList").style.backgroundColor="#E63594",document.getElementById("rpBtnMap").style.backgroundColor="#d9d9d9"}function btnShowMap(){document.getElementById("rpList").style.display="none",document.getElementById("rpGoogleMap").style.display="block","filtered-list"==state&&(state="filtered-list-map",console.log("State: "+state),document.getElementById("backArrow").style.display="inline-block"),"establishment-page"==state&&(state="establishment-page-map",console.log("State: "+state)),applyFilters(),document.getElementById("rpbtnList").style.backgroundColor="#d9d9d9",document.getElementById("rpBtnMap").style.backgroundColor="#E63594"}function onlyUnique(e,t,s){return s.indexOf(e)===t}function addCellTopSpecial(e,t){var s=document.createElement("td");s.innerHTML=t,s.colSpan=2,s.classList.add("cellTopSpecialCSS"),e.appendChild(s)}function addRowTopSpecial(e,t,s){var l=document.createElement("tr");l.id=s,addCellTopSpecial(l,t),e.appendChild(l)}function addCellTop(e,t){var s=document.createElement("td");s.innerHTML=t,s.colSpan=2,s.classList.add("cellTopCSS"),e.appendChild(s)}function addRowTop(e,t,s){var l=document.createElement("tr");l.id=s,addCellTop(l,t),e.appendChild(l)}function addCellBottom(e,t){var s=document.createElement("td");s.innerHTML=t,s.classList.add("cellBottomCSS"),e.appendChild(s)}function addRowBottom(e,t,s,l){var a=document.createElement("tr");a.id=l,addCellBottom(a,t),addCellBottom(a,s),e.appendChild(a)}function research(){initialSearch=!1,suburb=document.getElementById("researchInput").value,localStorage.setItem("usersSuburb",suburb),masterEstablishments=[],masterMarkers=[],state="filtered-list",console.log("State: "+state),pageOnLoad()}function tConvert(e){return(e=e.toString().match(/^([01]\d|2[0-3])(:)([0-5]\d)(:[0-5]\d)?$/)||[e]).length>1&&((e=e.slice(1))[5]=+e[0]<12?" AM":" PM",e[0]=+e[0]%12||12),e.join("")}function setMapOnAll(e){for(var t=0;t<filteredMarkers.length;t++)console.log(filteredMarkers[t].coords.lat),filteredMarkers.setMap(e)}function drinkFoodVisuals(e){"food"==e?(document.getElementById("tab-food-img").src="images/burger-yellow.png",document.getElementById("tabFood").style.backgroundColor="#E63594",document.getElementById("tab-drink-img").src="images/cocktail-white.png",document.getElementById("tabDrink").style.backgroundColor="#888F91",document.getElementById("cusineTypeFilterWrapper").style.display="block"):"drink"==e&&(document.getElementById("tab-food-img").src="images/burger-white.png",document.getElementById("tabFood").style.backgroundColor="#888F91",document.getElementById("tab-drink-img").src="images/cocktail-yellow.png",document.getElementById("tabDrink").style.backgroundColor="#E63594",document.getElementById("cusineTypeFilterWrapper").style.display="none")}function sortEstablishmentSpecials(e,t){e[t].establishmentSpecials.sort(function(e,t){return e.Start_Time.localeCompare(t.Start_Time)||e.End_Time.localeCompare(t.End_Time)||e.Description.localeCompare(t.Description)})}function sortSpecials(e){e.sort(function(e,t){return e.Start_Time.localeCompare(t.Start_Time)||e.End_Time.localeCompare(t.End_Time)||e.Description.localeCompare(t.Description)})}function daysAbbreviated(e,t,s){var l=[];l=void 0===t?e[s].Days_Of_Week.split(", "):e[t].establishmentSpecials[s].Days_Of_Week.split(", ");for(var a="M",i="T",n="W",r="T",o="F",d="S",c="S",m=0;m<l.length;m++)"Monday"==l[m]?a=(a=a.fontcolor("#E63594")).bold():"Tuesday"==l[m]?i=(i=i.fontcolor("#E63594")).bold():"Wednesday"==l[m]?n=(n=n.fontcolor("#E63594")).bold():"Thursday"==l[m]?r=(r=r.fontcolor("#E63594")).bold():"Friday"==l[m]?o=(o=o.fontcolor("#E63594")).bold():"Saturday"==l[m]?d=(d=d.fontcolor("#E63594")).bold():"Sunday"==l[m]&&(c=(c=c.fontcolor("#E63594")).bold("300px"));return a+i+n+r+o+d+c}function goBack(){console.log("Go back"),"establishment-page"==state?btnShowList():"establishment-page-map"==state?btnShowList():"filtered-list-map"==state&&btnShowList()}document.addEventListener("DOMContentLoaded",function(){pageOnLoad()}),$(document).on("click","#viewEstablishmentPage",function(){document.getElementById("nav-bar").scrollIntoView();for(var e=$(this).attr("data-id"),t=document.getElementById("myTable"+e),s=0,l=masterEstablishments.length;s<l;s++)if(e==masterEstablishments[s].objectId){console.log(masterEstablishments[s]),document.getElementById("rpList").innerHTML='<div><img class="rpImage" src="'+masterEstablishments[s].Image+'"><br><span class="est-name">'+masterEstablishments[s].Name+'</span><hr class="est-name-underline"><br><br><br><div class="est-details" id="estDetails"><div class="est-detail">'+masterEstablishments[s].Cuisine_Type+"</div>"+masterEstablishments[s].Address+"<br>"+masterEstablishments[s].Suburb+", "+masterEstablishments[s].Postcode+'<br><br><button class="google-website-btns google-btn btn-small" onclick="window.open(\''+masterEstablishments[s].Google_Business_Link+"');\">Directions</button></div></div>",null!=masterEstablishments[s].Website_Link&&(console.log("No website link"),document.getElementById("estDetails").innerHTML+='<button class="google-website-btns btn-small" onclick="window.open(\''+masterEstablishments[s].Website_Link+"');\">Website</button>"),document.getElementById("rpList").innerHTML+='<div class="tbl-wrapper" ><table id=\'tbl\' class="striped"><colgroup><col span="1" class="tbl-special"><col span="1" class="tbl-days"></colgroup><tbody id="myTable'+s+'"></tbody></table></div>';for(var a=[],i=0,n=t.rows.length;i<n;i++)a.push(t.rows[i].id),i++;var r=[],o=masterEstablishments[s],d=[],c=0,m=o.establishmentSpecials.length;for(c=0;c<m;c++)d.push(o.establishmentSpecials[c]);var p=d,b=[];sortSpecials(b=d.filter(e=>!a.includes(e.objectId))),sortSpecials(r=p.filter(e=>a.includes(e.objectId)));for(var g=0,u=b.length;g<u;g++)b[g].otherSpecials=void 0;b.length>0&&(b[0].otherSpecials="yes");var y;y=r.concat(b);for(var h=0;h<y.length;h++){var f,S=document.getElementById("myTable"+s);f="Drink"==y[h].Type_Of_Special?'<img class="cocktail-small-img" src="images/cocktail-yellow.png">':'<img class="hamburger-small-img" src="images/burger-black.png">',0==h?(addRowTop(S,"Specials matching your search criteria",y[h].objectId),addRowTopSpecial(S,f+y[h].Description,y[h].objectId),addRowBottom(S,'<img class="time-img" src="images/clock-small.png"><div class="time-period">'+tConvert(y[h].Start_Time)+" - "+tConvert(y[h].End_Time)+"</div>",'<img class="calander-img" src="images/calander-small.png"><div class="daysAbbreviated">'+daysAbbreviated(y,void 0,h)+"</div>",y[h].objectId)):"yes"==y[h].otherSpecials?(addRowTop(S,"Other specials on offer",y[h].objectId),addRowTopSpecial(S,f+y[h].Description,y[h].objectId),addRowBottom(S,'<img class="time-img" src="images/clock-small.png"><div class="time-period">'+tConvert(y[h].Start_Time)+" - "+tConvert(y[h].End_Time)+"</div>",'<img class="calander-img" src="images/calander-small.png"><div class="daysAbbreviated">'+daysAbbreviated(y,void 0,h)+"</div>",y[h].objectId)):(addRowTopSpecial(S,f+y[h].Description,y[h].objectId),addRowBottom(S,'<img class="time-img" src="images/clock-small.png"><div class="time-period">'+tConvert(y[h].Start_Time)+" - "+tConvert(y[h].End_Time)+"</div>",'<img class="calander-img" src="images/calander-small.png"><div class="daysAbbreviated">'+daysAbbreviated(y,void 0,h)+"</div>",y[h].objectId))}document.getElementById("rpNumOfSpecialsFound").innerHTML=masterEstablishments[s].Name,document.getElementById("rpList").innerHTML+='<div class="est-line-break"></div>'}document.getElementById("backArrow").style.display="inline-block",state="establishment-page",console.log("State: "+state)});