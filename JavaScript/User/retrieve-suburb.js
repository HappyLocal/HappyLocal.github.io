Backendless.serverURL="https://api.backendless.com",Backendless.initApp("073669A8-CCB7-2AED-FFEC-841A4CE5F400","FAFDE171-5308-49CF-9980-AA89E4F28F0C");var map,suburb=localStorage.getItem("usersSuburb"),initialSearch=!0,_typeOfSpecial=["Drink"],masterEstablishments=[],masterMarkers=[],filteredMarkers=[],useFilteredMarkers=!1,markers=[],mapInitialized=!1,lat=0,lng=0,zoom=14,state="filtered-list";function pageOnLoad(){if(!initialSearch){useFilteredMarkers=!1,$("#daysOfWeekFilter").val("");var e=document.getElementById("daysOfWeekFilter");e.options[0]=new Option("Any",""),e.options[0].disabled=!0,document.getElementById("timePeriodStartFilter").selectedIndex="0",document.getElementById("timePeriodEndFilter").selectedIndex="16",$("#specialCategoryFilter").val("");var t=document.getElementById("specialCategoryFilter");t.options[0]=new Option("Any",""),t.options[0].disabled=!0;a=0;var s=Backendless.DataQueryBuilder.create();return s.setRelated(["establishmentSpecials"]),s.setWhereClause("Suburb = '"+suburb+"' and Visible = TRUE"),s.setPageSize(100).setOffset(0),Backendless.Data.of("Establishment").find(s).then(function(e){document.getElementById("rpList").innerHTML="";for(var t=[],s=0,l=e.length;s<l;s++)for(var i=0,n=e[s].establishmentSpecials.length;i<n;i++)0==e[s].establishmentSpecials[i].Visible&&t.push(e[s].establishmentSpecials[i].objectId);e=e.reduce((e,s)=>{const l=s.establishmentSpecials.filter(e=>!t.includes(e.objectId));return l.length>0?[...e,{...s,establishmentSpecials:l}]:e},[]);for(var r=["Drink"],o=e.reduce((e,t)=>{const s=t.establishmentSpecials.filter(e=>r.includes(e.Type_Of_Special));return s.length>0?[...e,{...t,establishmentSpecials:s}]:e},[]),c=0;c<o.length;c++)if(o[c].establishmentSpecials.length>0){sortEstablishmentSpecials(o,c),document.getElementById("rpList").innerHTML+='<div class="establishment-wrapper"  data-id="'+o[c].objectId+'" id="viewEstablishmentPage"><img class="rpImage" src="'+o[c].Image+'"><br><span class="est-name">'+o[c].Name+'</span><hr class="est-name-underline"></div>',document.getElementById("rpList").innerHTML+='<div class="tbl-wrapper" ><table id=\'tbl\'  class="striped"><colgroup><col span="1" class="tbl-special"><col span="1" class="tbl-days"></colgroup><tbody id="myTable'+o[c].objectId+'"></tbody></table></div>';for(var d=0;d<o[c].establishmentSpecials.length;d++){var m=document.getElementById("myTable"+o[c].objectId);addRowTopSpecial(m,'<img class="cocktail-small-img" src="images/cocktail-yellow.png">'+o[c].establishmentSpecials[d].Description,o[c].establishmentSpecials[d].objectId),addRowBottom(m,'<img class="time-img" src="images/clock-small.png"><div class="time-period">'+tConvert(o[c].establishmentSpecials[d].Start_Time)+" - "+tConvert(o[c].establishmentSpecials[d].End_Time)+"</div>",'<img class="calander-img" src="images/calander-small.png"><div class="daysAbbreviated">'+daysAbbreviated(o,c,d)+"</div>",o[c].establishmentSpecials[d].objectId),a++}document.getElementById("rpList").innerHTML+='<div class="est-line-break"></div>'}var p=document.getElementById("cusineTypeFilter");$("#cusineTypeFilter").empty();var b=[],g=0,u=e.length,h=0;for(g=0;g<u;g++){var y=!1;for(h=0;h<e[g].establishmentSpecials.length;h++)if("Food"==e[g].establishmentSpecials[h].Type_Of_Special){y=!0;break}if(1==y){if(e[g].Cuisine_Type.includes(", "))for(var f=e[g].Cuisine_Type.split(", "),S=0,k=f.length;S<k;S++)b.push(f[S]);else b.push(e[g].Cuisine_Type);0}}var E=b.filter(onlyUnique);E.sort();var v=1,I=0,M=E.length;for(I=0;I<M;I++)p.options[0]=new Option("Any",""),p.options[0].disabled=!0,p.options[v]=new Option(E[I],E[I]),v++;drinkFoodVisuals("drink"),_typeOfSpecial=["Drink"],masterEstablishments=e,document.getElementById("rpNumOfSpecialsFound").innerHTML="Found '"+a+"' matching Drink specials";var T="No results";e.length>0&&(T=e[0].Postcode),document.getElementById("displaySuburb").innerHTML='<span class="display-suburb">'+suburb+", "+T+"</span>","block"==document.getElementById("rpGoogleMap").style.display&&(document.getElementById("rpGoogleMap").style.display="none",document.getElementById("rpList").style.display="block",document.getElementById("rpbtnList").style.backgroundColor="#E63594",document.getElementById("rpBtnMap").style.backgroundColor="#d9d9d9"),document.getElementById("cusineTypeFilter").disabled=!0,$("select").formSelect(),document.getElementById("backArrow").style.display="none",console.log("1. Populate list")}).then(()=>{if(console.log("2. Get suburb coords"),0==masterEstablishments.length)lat=-33.8707786,lng=151.2526313,zoom=4,map.setCenter({lat:lat,lng:lng}),map.setZoom(4),console.log("zoom set to 4");else{var e=[],t=0,s=masterEstablishments.length;for(t=0;t<s;t++){var l=[];l.push(masterEstablishments[t].Location.y),l.push(masterEstablishments[t].Location.x),e.push(l)}var a=center(e);lat=a[0],lng=a[1],map.setCenter({lat:lat,lng:lng}),zoom=14,map.setZoom(14),console.log("zoom set to 14")}console.log("3. Start map markers creation");for(var i=0;i<masterEstablishments.length;i++)if(masterEstablishments[i].establishmentSpecials.length>0){console.log("4.1 Start creating a single marker");masterMarkers.push({position:{lat:masterEstablishments[i].Location.y,lng:masterEstablishments[i].Location.x},iconImage:"images/restaurant.png",content:masterEstablishments[i].Name+"<br>"+masterEstablishments[i].Cuisine_Type+"<br>"+masterEstablishments[i].Address+"<br>",Name:masterEstablishments[i].Name,Address:masterEstablishments[i].Address,Cuisine_Type:masterEstablishments[i].Cuisine_Type,establishmentSpecials:masterEstablishments[i].establishmentSpecials,objectId:masterEstablishments[i].objectId}),console.log("4.2 Finish creating a single marker")}console.log("5. Finish map markers creation"),deleteMarkers()}).catch(function(e){})}var l=sessionStorage.getItem("suburbResults");l=JSON.parse(l),document.getElementById("rpList").innerHTML="";var a=0;console.log("Full objectArray"),console.log(l);var i=["Drink"],n=l.reduce((e,t)=>{const s=t.establishmentSpecials.filter(e=>i.includes(e.Type_Of_Special));return s.length>0?[...e,{...t,establishmentSpecials:s}]:e},[]);console.log("Drink Filtered objectArray"),console.log(n);for(var r=0;r<n.length;r++)if(n[r].establishmentSpecials.length>0){sortEstablishmentSpecials(n,r),document.getElementById("rpList").innerHTML+='<div class="establishment-wrapper"  data-id="'+n[r].objectId+'" id="viewEstablishmentPage"><img class="rpImage" src="'+n[r].Image+'"><br><span class="est-name">'+n[r].Name+'</span><hr class="est-name-underline"></div>',document.getElementById("rpList").innerHTML+='<div class="tbl-wrapper" ><table id=\'tbl\' class="striped"><colgroup><col span="1" class="tbl-special"><col span="1" class="tbl-days"></colgroup><tbody id="myTable'+n[r].objectId+'"></tbody></table></div>';for(var o=0;o<n[r].establishmentSpecials.length;o++){var c=document.getElementById("myTable"+n[r].objectId);addRowTopSpecial(c,'<img class="cocktail-small-img" src="images/cocktail-yellow.png">'+n[r].establishmentSpecials[o].Description,n[r].establishmentSpecials[o].objectId),addRowBottom(c,'<img class="time-img" src="images/clock-small.png"><div class="time-period">'+tConvert(n[r].establishmentSpecials[o].Start_Time)+" - "+tConvert(n[r].establishmentSpecials[o].End_Time)+"</div>",'<img class="calander-img" src="images/calander-small.png"><div class="daysAbbreviated">'+daysAbbreviated(n,r,o)+"</div>",n[r].establishmentSpecials[o].objectId),a++}document.getElementById("rpList").innerHTML+='<div class="est-line-break"></div>'}var d=document.getElementById("cusineTypeFilter");$("#cusineTypeFilter").empty();var m=[],p=0,b=l.length,g=0;for(p=0;p<b;p++){var u=!1;for(g=0;g<l[p].establishmentSpecials.length;g++)if("Food"==l[p].establishmentSpecials[g].Type_Of_Special){u=!0;break}if(1==u){if(l[p].Cuisine_Type.includes(", "))for(var h=l[p].Cuisine_Type.split(", "),y=0,f=h.length;y<f;y++)m.push(h[y]);else m.push(l[p].Cuisine_Type);0}}var S=m.filter(onlyUnique);S.sort();var k=1,E=0,v=S.length;for(E=0;E<v;E++)d.options[0]=new Option("Any",""),d.options[0].disabled=!0,d.options[k]=new Option(S[E],S[E]),k++;masterEstablishments=l;var I="No results";l.length>0&&(I=l[0].Postcode),document.getElementById("displaySuburb").innerHTML='<span class="display-suburb">'+suburb+", "+I+"</span>",console.log("1. Populate list"),document.getElementById("rpNumOfSpecialsFound").innerHTML="Found '"+a+"' matching Drink specials",document.getElementById("rpbtnList").style.backgroundColor="#E63594";var T=document.querySelectorAll("select");if(M.FormSelect.init(T),console.log("State: "+state),initialSearch){if(console.log("2. Get suburb coords"),0==masterEstablishments.length)lat=-33.8707786,lng=151.2526313,zoom=4;else{var B=[],_=0,C=masterEstablishments.length;for(_=0;_<C;_++){var L=[];L.push(masterEstablishments[_].Location.coordinates[1]),L.push(masterEstablishments[_].Location.coordinates[0]),B.push(L)}var F=center(B);lat=F[0],lng=F[1]}console.log("3. Start map markers creation");for(r=0;r<masterEstablishments.length;r++){if(masterEstablishments[r].establishmentSpecials.length>0){o=0;var w,O=masterEstablishments[r].establishmentSpecials.length;for(o=0;o<O;o++)"Drink"==masterEstablishments[r].establishmentSpecials[o].Type_Of_Special&&(w+=masterEstablishments[r].establishmentSpecials[o].Description+"<br>");console.log("4.1 Start creating a single marker");masterMarkers.push({position:{lat:masterEstablishments[r].Location.coordinates[1],lng:masterEstablishments[r].Location.coordinates[0]},iconImage:"images/restaurant.png",content:masterEstablishments[r].Name+"<br>"+masterEstablishments[r].Cuisine_Type+"<br>"+masterEstablishments[r].Address+"<br>"+w,Name:masterEstablishments[r].Name,Address:masterEstablishments[r].Address,Cuisine_Type:masterEstablishments[r].Cuisine_Type,establishmentSpecials:masterEstablishments[r].establishmentSpecials,objectId:masterEstablishments[r].objectId}),console.log("4.2 Finish creating a single marker")}w=""}console.log("5. Finish map markers creation")}}function initMap(){console.log("7. Map Initialization started");var e,t={zoom:zoom,center:{lat:lat,lng:lng}};if(console.log("8. Start print markers"),console.log("9. End print markers"),0==mapInitialized&&(map=new google.maps.Map(document.getElementById("rpGoogleMap"),t),console.log("Running first time"),mapInitialized=!0),console.log("10. Map created"),console.log("10.1 clear markers"),0==useFilteredMarkers)for(var s=0;s<masterMarkers.length;s++)l(masterMarkers[s]);else{console.log("initMap - User filtered markers");for(s=0;s<filteredMarkers.length;s++)l(filteredMarkers[s])}function l(t){var s=new google.maps.Marker({position:t.position,map:map,Name:t.Name,Address:t.Address,Cuisine_Type:t.Cusine_Type,establishmentSpecials:t.establishmentSpecials,objectId:t.objectId});if(t.iconImage&&s.setIcon(t.iconImage),t.content){var l=new google.maps.InfoWindow({content:t.content});s.addListener("click",function(){e&&e.close(),l.open(map,s),e=l})}markers.push(s)}console.log("11. Markers added")}function setMapOnAll(e){console.log("201. setMapOnAll clear marker"),console.log(filteredMarkers.length),console.log(filteredMarkers),console.log(markers);for(var t=0;t<markers.length;t++)markers[t].setMap(e)}function clearMarkers(){setMapOnAll(null)}function deleteMarkers(){clearMarkers(),markers=[]}function daysOfWeekFilter(){document.getElementById("rpGoogleMap").style.display="none",document.getElementById("rpList").style.display="block",state="filtered-list",console.log("State: "+state),applyFilters(),document.getElementById("backArrow").style.display="none"}function timePeriodFilter(){document.getElementById("rpGoogleMap").style.display="none",document.getElementById("rpList").style.display="block",state="filtered-list",console.log("State: "+state),applyFilters(),document.getElementById("backArrow").style.display="none"}function specialCategoryFilter(){document.getElementById("rpGoogleMap").style.display="none",document.getElementById("rpList").style.display="block",state="filtered-list",console.log("State: "+state),applyFilters(),document.getElementById("backArrow").style.display="none"}function cusineTypeFilter(){document.getElementById("rpGoogleMap").style.display="none",document.getElementById("rpList").style.display="block",state="filtered-list",console.log("State: "+state),applyFilters(),document.getElementById("backArrow").style.display="none"}function establishmentTypeFilter(){state="filtered-list",console.log("State: "+state),applyFilters()}function typeOfSpecialFilterDrink(){drinkFoodVisuals("drink"),document.getElementById("rpGoogleMap").style.display="none",document.getElementById("rpList").style.display="block",document.getElementById("cusineTypeFilter").disabled=!0,$("select").formSelect(),_typeOfSpecial=["Drink"],state="filtered-list",console.log("State: "+state),applyFilters(),document.getElementById("backArrow").style.display="none"}function typeOfSpecialFilterFood(){drinkFoodVisuals("food"),document.getElementById("rpGoogleMap").style.display="none",document.getElementById("rpList").style.display="block",document.getElementById("cusineTypeFilter").disabled=!1,$("select").formSelect(),_typeOfSpecial=["Food"],state="filtered-list",console.log("State: "+state),applyFilters(),document.getElementById("backArrow").style.display="none"}function applyFilters(){for(var e=$("#daysOfWeekFilter").val(),t=$("#timePeriodStartFilter").val(),s=$("#timePeriodEndFilter").val(),l=$("#specialCategoryFilter").val(),a=$("#cusineTypeFilter").val(),i=_typeOfSpecial,n=masterEstablishments,r=[],o=0;o<n.length;o++)for(var c=0;c<n[o].establishmentSpecials.length;c++){var d=[];if(n[o].establishmentSpecials[c].Days_Of_Week.includes(", "))for(var m=n[o].establishmentSpecials[c].Days_Of_Week.split(", "),p=0,b=m.length;p<b;p++)d.push(m[p]);else d.push(n[o].establishmentSpecials[c].Days_Of_Week);for(var g=0;g<e.length;g++)1==d.includes(e[g])&&r.push(n[o].establishmentSpecials[c].objectId)}e.length>=1&&r.length>=0&&(n=n.reduce((e,t)=>{const s=t.establishmentSpecials.filter(e=>r.includes(e.objectId));return s.length>0?[...e,{...t,establishmentSpecials:s}]:e},[]));var u=60*t.substring(0,2)+ +t.substring(3,5),h=60*s.substring(0,2)+ +s.substring(3,5),y=[];for(o=0;o<n.length;o++)for(c=0;c<n[o].establishmentSpecials.length;c++){var f=n[o].establishmentSpecials[c].Start_Time,S=n[o].establishmentSpecials[c].End_Time;f=60*f.substring(0,2)+ +f.substring(3,5),(S=60*S.substring(0,2)+ +S.substring(3,5))>u&&f<h&&u<h&&y.push(n[o].establishmentSpecials[c].objectId)}if(y.length>=0&&(n=n.reduce((e,t)=>{const s=t.establishmentSpecials.filter(e=>y.includes(e.objectId));return s.length>0?[...e,{...t,establishmentSpecials:s}]:e},[])),l.length>=1&&(n=n.reduce((e,t)=>{const s=t.establishmentSpecials.filter(e=>l.includes(e.Category));return s.length>0?[...e,{...t,establishmentSpecials:s}]:e},[])),"Food"==_typeOfSpecial[0]){var k=[];for(o=0;o<n.length;o++){var E=[];if(n[o].Cuisine_Type.includes(", ")){var v=n[o].Cuisine_Type.split(", ");for(p=0,b=v.length;p<b;p++)E.push(v[p])}else E.push(n[o].Cuisine_Type);for(g=0;g<a.length;g++)1==E.includes(a[g])&&k.push(n[o].objectId)}a.length>=1&&(n=n.filter(e=>k.includes(e.objectId)))}i.length>=1&&(n=n.reduce((e,t)=>{const s=t.establishmentSpecials.filter(e=>i.includes(e.Type_Of_Special));return s.length>0?[...e,{...t,establishmentSpecials:s}]:e},[]));var I=0;if("establishment-page-map"!=state){document.getElementById("rpList").innerHTML="";for(o=0;o<n.length;o++){sortEstablishmentSpecials(n,o),document.getElementById("rpList").innerHTML+='<div class="establishment-wrapper"  data-id="'+n[o].objectId+'" id="viewEstablishmentPage"><img class="rpImage" src="'+n[o].Image+'"><br><span class="est-name">'+n[o].Name+'</span><hr class="est-name-underline"></div>',document.getElementById("rpList").innerHTML+='<div class="tbl-wrapper" ><table id=\'tbl\' class="striped"><colgroup><col span="1" class="tbl-special"><col span="1" class="tbl-days"></colgroup><tbody id="myTable'+n[o].objectId+'"></tbody></table></div>';for(c=0;c<n[o].establishmentSpecials.length;c++){var M=document.getElementById("myTable"+n[o].objectId);addRowTopSpecial(M,("Drink"==_typeOfSpecial[0]?'<img class="cocktail-small-img" src="images/cocktail-yellow.png">':'<img class="hamburger-small-img" src="images/burger-black.png">')+n[o].establishmentSpecials[c].Description,n[o].establishmentSpecials[c].objectId),addRowBottom(M,'<img class="time-img" src="images/clock-small.png"><div class="time-period">'+tConvert(n[o].establishmentSpecials[c].Start_Time)+" - "+tConvert(n[o].establishmentSpecials[c].End_Time)+"</div>",'<img class="calander-img" src="images/calander-small.png"><div class="daysAbbreviated">'+daysAbbreviated(n,o,c)+"</div>",n[o].establishmentSpecials[c].objectId),I++}document.getElementById("rpList").innerHTML+='<div class="est-line-break"></div>'}document.getElementById("rpNumOfSpecialsFound").innerHTML="Found '"+I+"' matching "+_typeOfSpecial[0]+" specials"}if("block"==document.getElementById("rpGoogleMap").style.display){console.log("Map displayed"),useFilteredMarkers=!0,filteredMarkers=masterMarkers;var T=[];for(o=0;o<filteredMarkers.length;o++)for(c=0;c<filteredMarkers[o].establishmentSpecials.length;c++){var B=[];if(filteredMarkers[o].establishmentSpecials[c].Days_Of_Week.includes(", ")){var _=filteredMarkers[o].establishmentSpecials[c].Days_Of_Week.split(", ");for(p=0,b=_.length;p<b;p++)B.push(_[p])}else B.push(filteredMarkers[o].establishmentSpecials[c].Days_Of_Week);for(g=0;g<e.length;g++)1==B.includes(e[g])&&T.push(filteredMarkers[o].establishmentSpecials[c].objectId)}e.length>=1&&T.length>=0&&(filteredMarkers=filteredMarkers.reduce((e,t)=>{const s=t.establishmentSpecials.filter(e=>T.includes(e.objectId));return s.length>0?[...e,{...t,establishmentSpecials:s}]:e},[]));var C=60*t.substring(0,2)+ +t.substring(3,5),L=60*s.substring(0,2)+ +s.substring(3,5),F=[];for(o=0;o<filteredMarkers.length;o++)for(c=0;c<filteredMarkers[o].establishmentSpecials.length;c++){var w=filteredMarkers[o].establishmentSpecials[c].Start_Time,O=filteredMarkers[o].establishmentSpecials[c].End_Time;w=60*w.substring(0,2)+ +w.substring(3,5),(O=60*O.substring(0,2)+ +O.substring(3,5))>C&&w<L&&F.push(filteredMarkers[o].establishmentSpecials[c].objectId)}if(F.length>=0&&(filteredMarkers=filteredMarkers.reduce((e,t)=>{const s=t.establishmentSpecials.filter(e=>F.includes(e.objectId));return s.length>0?[...e,{...t,establishmentSpecials:s}]:e},[])),l.length>=1&&(filteredMarkers=filteredMarkers.reduce((e,t)=>{const s=t.establishmentSpecials.filter(e=>l.includes(e.Category));return s.length>0?[...e,{...t,establishmentSpecials:s}]:e},[])),"Food"==_typeOfSpecial[0]){var A=[];for(o=0;o<filteredMarkers.length;o++){var j=[];if(filteredMarkers[o].Cuisine_Type.includes(", ")){var D=filteredMarkers[o].Cuisine_Type.split(", ");for(p=0,b=D.length;p<b;p++)j.push(D[p])}else j.push(filteredMarkers[o].Cuisine_Type);for(g=0;g<a.length;g++)1==j.includes(a[g])&&A.push(filteredMarkers[o].objectId)}a.length>=1&&(filteredMarkers=filteredMarkers.filter(e=>A.includes(e.objectId)))}i.length>=1&&(filteredMarkers=filteredMarkers.reduce((e,t)=>{const s=t.establishmentSpecials.filter(e=>i.includes(e.Type_Of_Special));return s.length>0?[...e,{...t,establishmentSpecials:s}]:e},[]));var H=0,N=filteredMarkers.length;for(H=0;H<N;H++){var W="<b>"+filteredMarkers[H].Name+"</b><br>"+filteredMarkers[H].Cuisine_Type+"<br>"+filteredMarkers[H].Address+"<br><br>";sortEstablishmentSpecials(filteredMarkers,H);var R="",G=0,P=filteredMarkers[H].establishmentSpecials.length;for(G=0;G<P;G++)R+=filteredMarkers[H].establishmentSpecials[G].Description+"<br>"+tConvert(filteredMarkers[H].establishmentSpecials[G].Start_Time)+" - "+tConvert(filteredMarkers[H].establishmentSpecials[G].End_Time)+'<br><span class="dowMarker">'+daysAbbreviated(filteredMarkers,H,G)+"</span><br><br>";filteredMarkers[H].content=W+R}if("establishment-page-map"==state){console.log("State: Display establishment map marker");var z=function(e,t,s){for(var l=0,a=null;l<s&&-1!==a;)a=e.indexOf(t,a+1),l++;return a}((filteredMarkers=filteredMarkers.filter(e=>e.content.includes(document.getElementById("rpNumOfSpecialsFound").innerHTML)))[0].content,"<br>",3);filteredMarkers[0].content=[filteredMarkers[0].content.slice(0,z),"<br><br><b><i>Specials matching your search criteria</i></b>",filteredMarkers[0].content.slice(z)].join("");for(var x=[],V=0,U=filteredMarkers[0].establishmentSpecials.length;V<U;V++)x.push(filteredMarkers[0].establishmentSpecials[V].objectId);var q=masterMarkers,Z=(q=q.filter(e=>e.content.includes(document.getElementById("rpNumOfSpecialsFound").innerHTML)))[0].establishmentSpecials.filter(e=>!x.includes(e.objectId));sortSpecials(Z);var J="",Q=0,K=Z.length;if(K>0){for(;Q<K;Q++)J+=Z[Q].Description+"<br>"+tConvert(Z[Q].Start_Time)+" - "+tConvert(Z[Q].End_Time)+'<br><span class="dowMarker">'+daysAbbreviated(Z,void 0,Q)+"</span><br><br>";filteredMarkers[0].content+="<b><i>Other specials on offer</i></b><br><br>"+J}}console.log("202. filteredMarkers length after filtered: "+filteredMarkers.length),initMap()}document.getElementById("rpbtnList").style.backgroundColor="#E63594",document.getElementById("rpBtnMap").style.backgroundColor="#d9d9d9"}function btnShowList(){document.getElementById("rpGoogleMap").style.display="none",document.getElementById("rpList").style.display="block","Drink"!=_typeOfSpecial[0]&&(document.getElementById("cusineTypeFilter").disabled=!1,$("select").formSelect()),"establishment-page-map"==state?(state="establishment-page",console.log("State: "+state)):"establishment-page"==state?(state="filtered-list",console.log("State: "+state),applyFilters(),document.getElementById("backArrow").style.display="none"):"filtered-list-map"==state&&(state="filtered-list",document.getElementById("backArrow").style.display="none",console.log("State: "+state)),document.getElementById("rpbtnList").style.backgroundColor="#E63594",document.getElementById("rpBtnMap").style.backgroundColor="#d9d9d9"}function btnShowMap(){console.log("200. deleteMarkers() btnshowmap"),deleteMarkers(),document.getElementById("rpList").style.display="none",document.getElementById("rpGoogleMap").style.display="block","filtered-list"==state&&(state="filtered-list-map",console.log("State: "+state),document.getElementById("backArrow").style.display="inline-block"),"establishment-page"==state&&(state="establishment-page-map",console.log("State: "+state)),applyFilters(),document.getElementById("rpbtnList").style.backgroundColor="#d9d9d9",document.getElementById("rpBtnMap").style.backgroundColor="#E63594"}function onlyUnique(e,t,s){return s.indexOf(e)===t}function addCellTopSpecial(e,t){var s=document.createElement("td");s.innerHTML=t,s.colSpan=2,s.classList.add("cellTopSpecialCSS"),e.appendChild(s)}function addRowTopSpecial(e,t,s){var l=document.createElement("tr");l.id=s,addCellTopSpecial(l,t),e.appendChild(l)}function addCellTop(e,t){var s=document.createElement("td");s.innerHTML=t,s.colSpan=2,s.classList.add("cellTopCSS"),e.appendChild(s)}function addRowTop(e,t,s){var l=document.createElement("tr");l.id=s,addCellTop(l,t),e.appendChild(l)}function addCellBottom(e,t){var s=document.createElement("td");s.innerHTML=t,s.classList.add("cellBottomCSS"),e.appendChild(s)}function addRowBottom(e,t,s,l){var a=document.createElement("tr");a.id=l,addCellBottom(a,t),addCellBottom(a,s),e.appendChild(a)}function research(){initialSearch=!1,suburb=document.getElementById("researchInput").value,localStorage.setItem("usersSuburb",suburb),masterEstablishments=[],masterMarkers=[],state="filtered-list",console.log("State: "+state),pageOnLoad()}function tConvert(e){return(e=e.toString().match(/^([01]\d|2[0-3])(:)([0-5]\d)(:[0-5]\d)?$/)||[e]).length>1&&((e=e.slice(1))[5]=+e[0]<12?" AM":" PM",e[0]=+e[0]%12||12),e.join("")}function drinkFoodVisuals(e){"food"==e?(document.getElementById("tab-food-img").src="images/burger-yellow.png",document.getElementById("tabFood").style.backgroundColor="#E63594",document.getElementById("tab-drink-img").src="images/cocktail-white.png",document.getElementById("tabDrink").style.backgroundColor="#888F91",document.getElementById("cusineTypeFilterWrapper").style.display="block"):"drink"==e&&(document.getElementById("tab-food-img").src="images/burger-white.png",document.getElementById("tabFood").style.backgroundColor="#888F91",document.getElementById("tab-drink-img").src="images/cocktail-yellow.png",document.getElementById("tabDrink").style.backgroundColor="#E63594",document.getElementById("cusineTypeFilterWrapper").style.display="none")}function sortEstablishmentSpecials(e,t){e[t].establishmentSpecials.sort(function(e,t){return e.Start_Time.localeCompare(t.Start_Time)||e.End_Time.localeCompare(t.End_Time)||e.Description.localeCompare(t.Description)})}function sortSpecials(e){e.sort(function(e,t){return e.Start_Time.localeCompare(t.Start_Time)||e.End_Time.localeCompare(t.End_Time)||e.Description.localeCompare(t.Description)})}function daysAbbreviated(e,t,s){var l=[];l=void 0===t?e[s].Days_Of_Week.split(", "):e[t].establishmentSpecials[s].Days_Of_Week.split(", ");for(var a="M",i="T",n="W",r="T",o="F",c="S",d="S",m=0;m<l.length;m++)"Monday"==l[m]?a=(a=a.fontcolor("#E63594")).bold():"Tuesday"==l[m]?i=(i=i.fontcolor("#E63594")).bold():"Wednesday"==l[m]?n=(n=n.fontcolor("#E63594")).bold():"Thursday"==l[m]?r=(r=r.fontcolor("#E63594")).bold():"Friday"==l[m]?o=(o=o.fontcolor("#E63594")).bold():"Saturday"==l[m]?c=(c=c.fontcolor("#E63594")).bold():"Sunday"==l[m]&&(d=(d=d.fontcolor("#E63594")).bold("300px"));return a+i+n+r+o+c+d}function goBack(){console.log("Go back"),"establishment-page"==state?btnShowList():"establishment-page-map"==state?btnShowList():"filtered-list-map"==state&&btnShowList()}document.addEventListener("DOMContentLoaded",function(){pageOnLoad()}),$(document).on("click","#viewEstablishmentPage",function(){document.getElementById("nav-bar").scrollIntoView();for(var e=$(this).attr("data-id"),t=document.getElementById("myTable"+e),s=0,l=masterEstablishments.length;s<l;s++)if(e==masterEstablishments[s].objectId){console.log(masterEstablishments[s]),document.getElementById("rpList").innerHTML='<div><img class="rpImage" src="'+masterEstablishments[s].Image+'"><br><span class="est-name">'+masterEstablishments[s].Name+'</span><hr class="est-name-underline"><br><br><br><div class="est-details" id="estDetails"><div class="est-detail">'+masterEstablishments[s].Cuisine_Type+"</div>"+masterEstablishments[s].Address+"<br>"+masterEstablishments[s].Suburb+", "+masterEstablishments[s].Postcode+'<br><br><button class="google-website-btns google-btn btn-small" onclick="window.open(\''+masterEstablishments[s].Google_Business_Link+"');\">Directions</button></div></div>",console.log(masterEstablishments[s].Website_Link),null!=masterEstablishments[s].Website_Link&&""!=masterEstablishments[s].Website_Link&&(console.log("No website link"),document.getElementById("estDetails").innerHTML+='<button class="google-website-btns btn-small" onclick="window.open(\''+masterEstablishments[s].Website_Link+"');\">Website</button>"),document.getElementById("rpList").innerHTML+='<div class="tbl-wrapper" ><table id=\'tbl\' class="striped"><colgroup><col span="1" class="tbl-special"><col span="1" class="tbl-days"></colgroup><tbody id="myTable'+s+'"></tbody></table></div>';for(var a=[],i=0,n=t.rows.length;i<n;i++)a.push(t.rows[i].id),i++;var r=[],o=masterEstablishments[s],c=[],d=0,m=o.establishmentSpecials.length;for(d=0;d<m;d++)c.push(o.establishmentSpecials[d]);var p=c,b=[];sortSpecials(b=c.filter(e=>!a.includes(e.objectId))),sortSpecials(r=p.filter(e=>a.includes(e.objectId)));for(var g=0,u=b.length;g<u;g++)b[g].otherSpecials=void 0;b.length>0&&(b[0].otherSpecials="yes");var h;h=r.concat(b);for(var y=0;y<h.length;y++){var f,S=document.getElementById("myTable"+s);f="Drink"==h[y].Type_Of_Special?'<img class="cocktail-small-img" src="images/cocktail-yellow.png">':'<img class="hamburger-small-img" src="images/burger-black.png">',0==y?(addRowTop(S,"Specials matching your search criteria",h[y].objectId),addRowTopSpecial(S,f+h[y].Description,h[y].objectId),addRowBottom(S,'<img class="time-img" src="images/clock-small.png"><div class="time-period">'+tConvert(h[y].Start_Time)+" - "+tConvert(h[y].End_Time)+"</div>",'<img class="calander-img" src="images/calander-small.png"><div class="daysAbbreviated">'+daysAbbreviated(h,void 0,y)+"</div>",h[y].objectId)):"yes"==h[y].otherSpecials?(addRowTop(S,"Other specials on offer",h[y].objectId),addRowTopSpecial(S,f+h[y].Description,h[y].objectId),addRowBottom(S,'<img class="time-img" src="images/clock-small.png"><div class="time-period">'+tConvert(h[y].Start_Time)+" - "+tConvert(h[y].End_Time)+"</div>",'<img class="calander-img" src="images/calander-small.png"><div class="daysAbbreviated">'+daysAbbreviated(h,void 0,y)+"</div>",h[y].objectId)):(addRowTopSpecial(S,f+h[y].Description,h[y].objectId),addRowBottom(S,'<img class="time-img" src="images/clock-small.png"><div class="time-period">'+tConvert(h[y].Start_Time)+" - "+tConvert(h[y].End_Time)+"</div>",'<img class="calander-img" src="images/calander-small.png"><div class="daysAbbreviated">'+daysAbbreviated(h,void 0,y)+"</div>",h[y].objectId))}document.getElementById("rpNumOfSpecialsFound").innerHTML=masterEstablishments[s].Name,document.getElementById("rpList").innerHTML+='<div class="est-line-break"></div>'}document.getElementById("backArrow").style.display="inline-block",state="establishment-page",console.log("State: "+state)});var center=function(e){var t=e.map(function(e){return e[0]}),s=e.map(function(e){return e[1]});return[(Math.min.apply(null,t)+Math.max.apply(null,t))/2,(Math.min.apply(null,s)+Math.max.apply(null,s))/2]};