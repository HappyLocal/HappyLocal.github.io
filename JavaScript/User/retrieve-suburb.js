Backendless.serverURL="https://api.backendless.com",Backendless.initApp("073669A8-CCB7-2AED-FFEC-841A4CE5F400","FAFDE171-5308-49CF-9980-AA89E4F28F0C");var map,suburb=localStorage.getItem("usersSuburb"),initialSearch=!0,_typeOfSpecial=["Drink"],masterEstablishments=[],masterMarkers=[],filteredMarkers=[],useFilteredMarkers=!1,markers=[],mapInitialized=!1,lat=0,lng=0,zoom=14,state="filtered-list";function pageOnLoad(){if(!initialSearch){useFilteredMarkers=!1,$("#daysOfWeekFilter").val("");var e=document.getElementById("daysOfWeekFilter");e.options[0]=new Option("Any",""),e.options[0].disabled=!0,document.getElementById("timePeriodStartFilter").selectedIndex="0",document.getElementById("timePeriodEndFilter").selectedIndex="16",$("#specialCategoryFilter").val("");var t=document.getElementById("specialCategoryFilter");t.options[0]=new Option("Any",""),t.options[0].disabled=!0;l=0;var s=Backendless.DataQueryBuilder.create();return s.setRelated(["establishmentSpecials"]),s.setWhereClause("Suburb = '"+suburb+"' and Visible = TRUE"),s.setPageSize(100).setOffset(0),Backendless.Data.of("Establishment").find(s).then(function(e){document.getElementById("rpList").innerHTML="";for(var t=[],s=0,a=e.length;s<a;s++)for(var i=0,n=e[s].establishmentSpecials.length;i<n;i++)0==e[s].establishmentSpecials[i].Visible&&t.push(e[s].establishmentSpecials[i].objectId);e=e.reduce((e,s)=>{const a=s.establishmentSpecials.filter(e=>!t.includes(e.objectId));return a.length>0?[...e,{...s,establishmentSpecials:a}]:e},[]);for(var r=["Drink"],o=e.reduce((e,t)=>{const s=t.establishmentSpecials.filter(e=>r.includes(e.Type_Of_Special));return s.length>0?[...e,{...t,establishmentSpecials:s}]:e},[]),d=0;d<o.length;d++)if(o[d].establishmentSpecials.length>0){sortEstablishmentSpecials(o,d),document.getElementById("rpList").innerHTML+='<div class="establishment-wrapper"  data-id="'+o[d].objectId+'" id="viewEstablishmentPage"><img class="rpImage" src="'+o[d].Image+'"><br><span class="est-name">'+o[d].Name+'</span><hr class="est-name-underline"></div>',document.getElementById("rpList").innerHTML+='<div class="tbl-wrapper" ><table id=\'tbl\'  class="striped"><colgroup><col span="1" class="tbl-special"><col span="1" class="tbl-days"></colgroup><tbody id="myTable'+o[d].objectId+'"></tbody></table></div>';for(var c=0;c<o[d].establishmentSpecials.length;c++){var m=document.getElementById("myTable"+o[d].objectId);addRowTopSpecial(m,'<img class="cocktail-small-img" src="images/cocktail-yellow.png">'+o[d].establishmentSpecials[c].Description,o[d].establishmentSpecials[c].objectId),addRowBottom(m,'<img class="time-img" src="images/clock-trans.png"><div class="time-period">'+tConvert(o[d].establishmentSpecials[c].Start_Time)+" - "+tConvert(o[d].establishmentSpecials[c].End_Time)+"</div>",'<img class="calander-img" src="images/calander-trans.png"><div class="daysAbbreviated">'+daysAbbreviated(o,d,c)+"</div>",o[d].establishmentSpecials[c].objectId),l++}document.getElementById("rpList").innerHTML+='<div class="est-line-break"></div>'}var p=document.getElementById("cusineTypeFilter");$("#cusineTypeFilter").empty();var b=[],u=0,g=e.length,h=0;for(u=0;u<g;u++){var y=!1;for(h=0;h<e[u].establishmentSpecials.length;h++)if("Food"==e[u].establishmentSpecials[h].Type_Of_Special){y=!0;break}if(1==y){if(e[u].Cuisine_Type.includes(", "))for(var f=e[u].Cuisine_Type.split(", "),S=0,E=f.length;S<E;S++)b.push(f[S]);else b.push(e[u].Cuisine_Type);0}}var v=b.filter(onlyUnique);v.sort();var k=1,I=0,T=v.length;for(I=0;I<T;I++)p.options[0]=new Option("Any",""),p.options[0].disabled=!0,p.options[k]=new Option(v[I],v[I]),k++;drinkFoodVisuals("drink"),_typeOfSpecial=["Drink"],masterEstablishments=e,document.getElementById("rpNumOfSpecialsFound").innerHTML="Found '"+l+"' matching Drink specials";var M="No results";e.length>0&&(M=e[0].Postcode),document.getElementById("displaySuburb").innerHTML='<span class="display-suburb">'+suburb+", "+M+"</span>","block"==document.getElementById("rpGoogleMap").style.display&&(document.getElementById("rpGoogleMap").style.display="none",document.getElementById("rpList").style.display="block",document.getElementById("rpbtnList").style.backgroundColor="#E63594",document.getElementById("rpBtnMap").style.backgroundColor="#d9d9d9"),document.getElementById("cusineTypeFilter").disabled=!0,$("select").formSelect(),document.getElementById("backArrow").style.display="none"}).then(()=>{if(0==masterEstablishments.length)lat=-33.8707786,lng=151.2526313,zoom=4,map.setCenter({lat:lat,lng:lng}),map.setZoom(4);else{var e=[],t=0,s=masterEstablishments.length;for(t=0;t<s;t++){var a=[];a.push(masterEstablishments[t].Location.y),a.push(masterEstablishments[t].Location.x),e.push(a)}var l=center(e);lat=l[0],lng=l[1],map.setCenter({lat:lat,lng:lng}),zoom=14,map.setZoom(14)}for(var i=0;i<masterEstablishments.length;i++)if(masterEstablishments[i].establishmentSpecials.length>0){masterMarkers.push({position:{lat:masterEstablishments[i].Location.y,lng:masterEstablishments[i].Location.x},iconImage:"images/restaurant.png",content:masterEstablishments[i].Name+"<br>"+masterEstablishments[i].Cuisine_Type+"<br>"+masterEstablishments[i].Address+"<br>",Name:masterEstablishments[i].Name,Address:masterEstablishments[i].Address,Cuisine_Type:masterEstablishments[i].Cuisine_Type,establishmentSpecials:masterEstablishments[i].establishmentSpecials,objectId:masterEstablishments[i].objectId})}deleteMarkers()}).catch(function(e){})}var a=sessionStorage.getItem("suburbResults");a=JSON.parse(a),document.getElementById("rpList").innerHTML="";for(var l=0,i=["Drink"],n=a.reduce((e,t)=>{const s=t.establishmentSpecials.filter(e=>i.includes(e.Type_Of_Special));return s.length>0?[...e,{...t,establishmentSpecials:s}]:e},[]),r=0;r<n.length;r++)if(n[r].establishmentSpecials.length>0){sortEstablishmentSpecials(n,r),document.getElementById("rpList").innerHTML+='<div class="establishment-wrapper"  data-id="'+n[r].objectId+'" id="viewEstablishmentPage"><img class="rpImage" src="'+n[r].Image+'"><br><span class="est-name">'+n[r].Name+'</span><hr class="est-name-underline"></div>',document.getElementById("rpList").innerHTML+='<div class="tbl-wrapper" ><table id=\'tbl\' class="striped"><colgroup><col span="1" class="tbl-special"><col span="1" class="tbl-days"></colgroup><tbody id="myTable'+n[r].objectId+'"></tbody></table></div>';for(var o=0;o<n[r].establishmentSpecials.length;o++){var d=document.getElementById("myTable"+n[r].objectId);addRowTopSpecial(d,'<img class="cocktail-small-img" src="images/cocktail-yellow.png">'+n[r].establishmentSpecials[o].Description,n[r].establishmentSpecials[o].objectId),addRowBottom(d,'<img class="time-img" src="images/clock-trans.png"><div class="time-period">'+tConvert(n[r].establishmentSpecials[o].Start_Time)+" - "+tConvert(n[r].establishmentSpecials[o].End_Time)+"</div>",'<img class="calander-img" src="images/calander-trans.png"><div class="daysAbbreviated">'+daysAbbreviated(n,r,o)+"</div>",n[r].establishmentSpecials[o].objectId),l++}document.getElementById("rpList").innerHTML+='<div class="est-line-break"></div>'}var c=document.getElementById("cusineTypeFilter");$("#cusineTypeFilter").empty();var m=[],p=0,b=a.length,u=0;for(p=0;p<b;p++){var g=!1;for(u=0;u<a[p].establishmentSpecials.length;u++)if("Food"==a[p].establishmentSpecials[u].Type_Of_Special){g=!0;break}if(1==g){if(a[p].Cuisine_Type.includes(", "))for(var h=a[p].Cuisine_Type.split(", "),y=0,f=h.length;y<f;y++)m.push(h[y]);else m.push(a[p].Cuisine_Type);0}}var S=m.filter(onlyUnique);S.sort();var E=1,v=0,k=S.length;for(v=0;v<k;v++)c.options[0]=new Option("Any",""),c.options[0].disabled=!0,c.options[E]=new Option(S[v],S[v]),E++;masterEstablishments=a;var I="No results";a.length>0&&(I=a[0].Postcode),document.getElementById("displaySuburb").innerHTML='<span class="display-suburb">'+suburb+", "+I+"</span>",document.getElementById("rpNumOfSpecialsFound").innerHTML="Found '"+l+"' matching Drink specials",document.getElementById("rpbtnList").style.backgroundColor="#E63594";var T=document.querySelectorAll("select");if(M.FormSelect.init(T),initialSearch){if(0==masterEstablishments.length)lat=-33.8707786,lng=151.2526313,zoom=4;else{var B=[],_=0,C=masterEstablishments.length;for(_=0;_<C;_++){var F=[];F.push(masterEstablishments[_].Location.coordinates[1]),F.push(masterEstablishments[_].Location.coordinates[0]),B.push(F)}var L=center(B);lat=L[0],lng=L[1]}for(r=0;r<masterEstablishments.length;r++){if(masterEstablishments[r].establishmentSpecials.length>0){o=0;var w,O=masterEstablishments[r].establishmentSpecials.length;for(o=0;o<O;o++)"Drink"==masterEstablishments[r].establishmentSpecials[o].Type_Of_Special&&(w+=masterEstablishments[r].establishmentSpecials[o].Description+"<br>");masterMarkers.push({position:{lat:masterEstablishments[r].Location.coordinates[1],lng:masterEstablishments[r].Location.coordinates[0]},iconImage:"images/restaurant.png",content:masterEstablishments[r].Name+"<br>"+masterEstablishments[r].Cuisine_Type+"<br>"+masterEstablishments[r].Address+"<br>"+w,Name:masterEstablishments[r].Name,Address:masterEstablishments[r].Address,Cuisine_Type:masterEstablishments[r].Cuisine_Type,establishmentSpecials:masterEstablishments[r].establishmentSpecials,objectId:masterEstablishments[r].objectId})}w=""}}}function initMap(){var e,t={zoom:zoom,center:{lat:lat,lng:lng}};if(0==mapInitialized&&(map=new google.maps.Map(document.getElementById("rpGoogleMap"),t),mapInitialized=!0),0==useFilteredMarkers)for(var s=0;s<masterMarkers.length;s++)a(masterMarkers[s]);else for(s=0;s<filteredMarkers.length;s++)a(filteredMarkers[s]);function a(t){var s=new google.maps.Marker({position:t.position,map:map,Name:t.Name,Address:t.Address,Cuisine_Type:t.Cusine_Type,establishmentSpecials:t.establishmentSpecials,objectId:t.objectId});if(t.iconImage&&s.setIcon(t.iconImage),t.content){var a=new google.maps.InfoWindow({content:t.content});s.addListener("click",function(){e&&e.close(),a.open(map,s),e=a})}markers.push(s)}}function setMapOnAll(e){for(var t=0;t<markers.length;t++)markers[t].setMap(e)}function clearMarkers(){setMapOnAll(null)}function deleteMarkers(){clearMarkers(),markers=[]}function daysOfWeekFilter(){document.getElementById("rpGoogleMap").style.display="none",document.getElementById("rpList").style.display="block",state="filtered-list",applyFilters(),document.getElementById("backArrow").style.display="none"}function timePeriodFilter(){document.getElementById("rpGoogleMap").style.display="none",document.getElementById("rpList").style.display="block",state="filtered-list",applyFilters(),document.getElementById("backArrow").style.display="none"}function specialCategoryFilter(){document.getElementById("rpGoogleMap").style.display="none",document.getElementById("rpList").style.display="block",state="filtered-list",applyFilters(),document.getElementById("backArrow").style.display="none"}function cusineTypeFilter(){document.getElementById("rpGoogleMap").style.display="none",document.getElementById("rpList").style.display="block",state="filtered-list",applyFilters(),document.getElementById("backArrow").style.display="none"}function establishmentTypeFilter(){state="filtered-list",applyFilters()}function typeOfSpecialFilterDrink(){drinkFoodVisuals("drink"),document.getElementById("rpGoogleMap").style.display="none",document.getElementById("rpList").style.display="block",document.getElementById("cusineTypeFilter").disabled=!0,$("select").formSelect(),_typeOfSpecial=["Drink"],state="filtered-list",applyFilters(),document.getElementById("backArrow").style.display="none"}function typeOfSpecialFilterFood(){drinkFoodVisuals("food"),document.getElementById("rpGoogleMap").style.display="none",document.getElementById("rpList").style.display="block",document.getElementById("cusineTypeFilter").disabled=!1,$("select").formSelect(),_typeOfSpecial=["Food"],state="filtered-list",applyFilters(),document.getElementById("backArrow").style.display="none"}function applyFilters(){for(var e=$("#daysOfWeekFilter").val(),t=$("#timePeriodStartFilter").val(),s=$("#timePeriodEndFilter").val(),a=$("#specialCategoryFilter").val(),l=$("#cusineTypeFilter").val(),i=_typeOfSpecial,n=masterEstablishments,r=[],o=0;o<n.length;o++)for(var d=0;d<n[o].establishmentSpecials.length;d++){var c=[];if(n[o].establishmentSpecials[d].Days_Of_Week.includes(", "))for(var m=n[o].establishmentSpecials[d].Days_Of_Week.split(", "),p=0,b=m.length;p<b;p++)c.push(m[p]);else c.push(n[o].establishmentSpecials[d].Days_Of_Week);for(var u=0;u<e.length;u++)1==c.includes(e[u])&&r.push(n[o].establishmentSpecials[d].objectId)}e.length>=1&&r.length>=0&&(n=n.reduce((e,t)=>{const s=t.establishmentSpecials.filter(e=>r.includes(e.objectId));return s.length>0?[...e,{...t,establishmentSpecials:s}]:e},[]));var g=60*t.substring(0,2)+ +t.substring(3,5),h=60*s.substring(0,2)+ +s.substring(3,5),y=[];for(o=0;o<n.length;o++)for(d=0;d<n[o].establishmentSpecials.length;d++){var f=n[o].establishmentSpecials[d].Start_Time,S=n[o].establishmentSpecials[d].End_Time;f=60*f.substring(0,2)+ +f.substring(3,5),(S=60*S.substring(0,2)+ +S.substring(3,5))>g&&f<h&&g<h&&y.push(n[o].establishmentSpecials[d].objectId)}if(y.length>=0&&(n=n.reduce((e,t)=>{const s=t.establishmentSpecials.filter(e=>y.includes(e.objectId));return s.length>0?[...e,{...t,establishmentSpecials:s}]:e},[])),a.length>=1&&(n=n.reduce((e,t)=>{const s=t.establishmentSpecials.filter(e=>a.includes(e.Category));return s.length>0?[...e,{...t,establishmentSpecials:s}]:e},[])),"Food"==_typeOfSpecial[0]){var E=[];for(o=0;o<n.length;o++){var v=[];if(n[o].Cuisine_Type.includes(", ")){var k=n[o].Cuisine_Type.split(", ");for(p=0,b=k.length;p<b;p++)v.push(k[p])}else v.push(n[o].Cuisine_Type);for(u=0;u<l.length;u++)1==v.includes(l[u])&&E.push(n[o].objectId)}l.length>=1&&(n=n.filter(e=>E.includes(e.objectId)))}i.length>=1&&(n=n.reduce((e,t)=>{const s=t.establishmentSpecials.filter(e=>i.includes(e.Type_Of_Special));return s.length>0?[...e,{...t,establishmentSpecials:s}]:e},[]));var I=0;if("establishment-page-map"!=state){document.getElementById("rpList").innerHTML="";for(o=0;o<n.length;o++){sortEstablishmentSpecials(n,o),document.getElementById("rpList").innerHTML+='<div class="establishment-wrapper"  data-id="'+n[o].objectId+'" id="viewEstablishmentPage"><img class="rpImage" src="'+n[o].Image+'"><br><span class="est-name">'+n[o].Name+'</span><hr class="est-name-underline"></div>',document.getElementById("rpList").innerHTML+='<div class="tbl-wrapper" ><table id=\'tbl\' class="striped"><colgroup><col span="1" class="tbl-special"><col span="1" class="tbl-days"></colgroup><tbody id="myTable'+n[o].objectId+'"></tbody></table></div>';for(d=0;d<n[o].establishmentSpecials.length;d++){var T=document.getElementById("myTable"+n[o].objectId);addRowTopSpecial(T,("Drink"==_typeOfSpecial[0]?'<img class="cocktail-small-img" src="images/cocktail-yellow.png">':'<img class="hamburger-small-img" src="images/burger-black.png">')+n[o].establishmentSpecials[d].Description,n[o].establishmentSpecials[d].objectId),addRowBottom(T,'<img class="time-img" src="images/clock-trans.png"><div class="time-period">'+tConvert(n[o].establishmentSpecials[d].Start_Time)+" - "+tConvert(n[o].establishmentSpecials[d].End_Time)+"</div>",'<img class="calander-img" src="images/calander-trans.png"><div class="daysAbbreviated">'+daysAbbreviated(n,o,d)+"</div>",n[o].establishmentSpecials[d].objectId),I++}document.getElementById("rpList").innerHTML+='<div class="est-line-break"></div>'}document.getElementById("rpNumOfSpecialsFound").innerHTML="Found '"+I+"' matching "+_typeOfSpecial[0]+" specials"}if("block"==document.getElementById("rpGoogleMap").style.display){useFilteredMarkers=!0,filteredMarkers=masterMarkers;var M=[];for(o=0;o<filteredMarkers.length;o++)for(d=0;d<filteredMarkers[o].establishmentSpecials.length;d++){var B=[];if(filteredMarkers[o].establishmentSpecials[d].Days_Of_Week.includes(", ")){var _=filteredMarkers[o].establishmentSpecials[d].Days_Of_Week.split(", ");for(p=0,b=_.length;p<b;p++)B.push(_[p])}else B.push(filteredMarkers[o].establishmentSpecials[d].Days_Of_Week);for(u=0;u<e.length;u++)1==B.includes(e[u])&&M.push(filteredMarkers[o].establishmentSpecials[d].objectId)}e.length>=1&&M.length>=0&&(filteredMarkers=filteredMarkers.reduce((e,t)=>{const s=t.establishmentSpecials.filter(e=>M.includes(e.objectId));return s.length>0?[...e,{...t,establishmentSpecials:s}]:e},[]));var C=60*t.substring(0,2)+ +t.substring(3,5),F=60*s.substring(0,2)+ +s.substring(3,5),L=[];for(o=0;o<filteredMarkers.length;o++)for(d=0;d<filteredMarkers[o].establishmentSpecials.length;d++){var w=filteredMarkers[o].establishmentSpecials[d].Start_Time,O=filteredMarkers[o].establishmentSpecials[d].End_Time;w=60*w.substring(0,2)+ +w.substring(3,5),(O=60*O.substring(0,2)+ +O.substring(3,5))>C&&w<F&&L.push(filteredMarkers[o].establishmentSpecials[d].objectId)}if(L.length>=0&&(filteredMarkers=filteredMarkers.reduce((e,t)=>{const s=t.establishmentSpecials.filter(e=>L.includes(e.objectId));return s.length>0?[...e,{...t,establishmentSpecials:s}]:e},[])),a.length>=1&&(filteredMarkers=filteredMarkers.reduce((e,t)=>{const s=t.establishmentSpecials.filter(e=>a.includes(e.Category));return s.length>0?[...e,{...t,establishmentSpecials:s}]:e},[])),"Food"==_typeOfSpecial[0]){var j=[];for(o=0;o<filteredMarkers.length;o++){var A=[];if(filteredMarkers[o].Cuisine_Type.includes(", ")){var D=filteredMarkers[o].Cuisine_Type.split(", ");for(p=0,b=D.length;p<b;p++)A.push(D[p])}else A.push(filteredMarkers[o].Cuisine_Type);for(u=0;u<l.length;u++)1==A.includes(l[u])&&j.push(filteredMarkers[o].objectId)}l.length>=1&&(filteredMarkers=filteredMarkers.filter(e=>j.includes(e.objectId)))}i.length>=1&&(filteredMarkers=filteredMarkers.reduce((e,t)=>{const s=t.establishmentSpecials.filter(e=>i.includes(e.Type_Of_Special));return s.length>0?[...e,{...t,establishmentSpecials:s}]:e},[]));var N=0,H=filteredMarkers.length;for(N=0;N<H;N++){var R="<b>"+filteredMarkers[N].Name+"</b><br>"+filteredMarkers[N].Cuisine_Type+"<br>"+filteredMarkers[N].Address+"<br><br>";sortEstablishmentSpecials(filteredMarkers,N);var G="",W=0,P=filteredMarkers[N].establishmentSpecials.length;for(W=0;W<P;W++)G+=filteredMarkers[N].establishmentSpecials[W].Description+"<br>"+tConvert(filteredMarkers[N].establishmentSpecials[W].Start_Time)+" - "+tConvert(filteredMarkers[N].establishmentSpecials[W].End_Time)+'<br><span class="dowMarker">'+daysAbbreviated(filteredMarkers,N,W)+"</span><br><br>";filteredMarkers[N].content=R+G}if("establishment-page-map"==state){var z=function(e,t,s){for(var a=0,l=null;a<s&&-1!==l;)l=e.indexOf(t,l+1),a++;return l}((filteredMarkers=filteredMarkers.filter(e=>e.content.includes(document.getElementById("rpNumOfSpecialsFound").name)))[0].content,"<br>",3);filteredMarkers[0].content=[filteredMarkers[0].content.slice(0,z),"<br><br><b><i>Specials matching your search criteria</i></b>",filteredMarkers[0].content.slice(z)].join("");for(var x=[],V=0,U=filteredMarkers[0].establishmentSpecials.length;V<U;V++)x.push(filteredMarkers[0].establishmentSpecials[V].objectId);var q=masterMarkers,Z=(q=q.filter(e=>e.content.includes(document.getElementById("rpNumOfSpecialsFound").name)))[0].establishmentSpecials.filter(e=>!x.includes(e.objectId));sortSpecials(Z);var J="",Q=0,K=Z.length;if(K>0){for(;Q<K;Q++)J+=Z[Q].Description+"<br>"+tConvert(Z[Q].Start_Time)+" - "+tConvert(Z[Q].End_Time)+'<br><span class="dowMarker">'+daysAbbreviated(Z,void 0,Q)+"</span><br><br>";filteredMarkers[0].content+="<b><i>Other specials on offer</i></b><br><br>"+J}}initMap()}document.getElementById("rpbtnList").style.backgroundColor="#E63594",document.getElementById("rpBtnMap").style.backgroundColor="#d9d9d9"}function btnShowList(){document.getElementById("rpGoogleMap").style.display="none",document.getElementById("rpList").style.display="block","Drink"!=_typeOfSpecial[0]&&(document.getElementById("cusineTypeFilter").disabled=!1,$("select").formSelect()),"establishment-page-map"==state?(state="establishment-page",document.getElementById("rpNumOfSpecialsFound").innerHTML="<u>Back to results</u>"):"establishment-page"==state?(state="filtered-list",applyFilters(),document.getElementById("backArrow").style.display="none"):"filtered-list-map"==state&&(state="filtered-list",document.getElementById("backArrow").style.display="none"),document.getElementById("rpbtnList").style.backgroundColor="#E63594",document.getElementById("rpBtnMap").style.backgroundColor="#d9d9d9"}function btnShowMap(){deleteMarkers(),document.getElementById("rpList").style.display="none",document.getElementById("rpGoogleMap").style.display="block","filtered-list"==state&&(state="filtered-list-map",document.getElementById("backArrow").style.display="inline-block"),"establishment-page"==state&&(state="establishment-page-map",document.getElementById("rpNumOfSpecialsFound").innerHTML="<u>Back to "+document.getElementById("rpNumOfSpecialsFound").name+"</u>"),applyFilters(),document.getElementById("rpbtnList").style.backgroundColor="#d9d9d9",document.getElementById("rpBtnMap").style.backgroundColor="#E63594"}function onlyUnique(e,t,s){return s.indexOf(e)===t}function addCellTopSpecial(e,t){var s=document.createElement("td");s.innerHTML=t,s.colSpan=2,s.classList.add("cellTopSpecialCSS"),e.appendChild(s)}function addRowTopSpecial(e,t,s,a){var l=document.createElement("tr");l.id=s,addCellTopSpecial(l,t),"lightGrey"==a&&(l.style.backgroundColor="#ececec"),e.appendChild(l)}function addCellTop(e,t){var s=document.createElement("td");s.innerHTML=t,s.colSpan=2,s.classList.add("cellTopCSS"),e.appendChild(s)}function addCellTopNorm(e,t){var s=document.createElement("td");s.innerHTML=t,s.colSpan=2,s.classList.add("cellTopNormCSS"),e.appendChild(s)}function addRowTop(e,t,s,a,l){var i=document.createElement("tr");i.id=s,null==l?addCellTop(i,t):addCellTopNorm(i,t),"lightGrey"==a&&(i.style.backgroundColor="#ececec"),"blank"==a&&(i.style.lineHeight="2"),e.appendChild(i)}function addCellBottom(e,t){var s=document.createElement("td");s.innerHTML=t,s.classList.add("cellBottomCSS"),e.appendChild(s)}function addRowBottom(e,t,s,a,l){var i=document.createElement("tr");i.id=a,addCellBottom(i,t),addCellBottom(i,s),"lightGrey"==l&&(i.style.backgroundColor="#ececec"),e.appendChild(i)}function research(){initialSearch=!1,suburb=document.getElementById("researchInput").value,localStorage.setItem("usersSuburb",suburb),masterEstablishments=[],masterMarkers=[],state="filtered-list",pageOnLoad()}function tConvert(e){return(e=e.toString().match(/^([01]\d|2[0-3])(:)([0-5]\d)(:[0-5]\d)?$/)||[e]).length>1&&((e=e.slice(1))[5]=+e[0]<12?" AM":" PM",e[0]=+e[0]%12||12),e.join("")}function drinkFoodVisuals(e){"food"==e?(document.getElementById("tab-food-img").src="images/burger-yellow.png",document.getElementById("tabFood").style.backgroundColor="#E63594",document.getElementById("tab-drink-img").src="images/cocktail-white.png",document.getElementById("tabDrink").style.backgroundColor="#888F91",document.getElementById("cusineTypeFilterWrapper").style.display="block"):"drink"==e&&(document.getElementById("tab-food-img").src="images/burger-white.png",document.getElementById("tabFood").style.backgroundColor="#888F91",document.getElementById("tab-drink-img").src="images/cocktail-yellow.png",document.getElementById("tabDrink").style.backgroundColor="#E63594",document.getElementById("cusineTypeFilterWrapper").style.display="none")}function sortEstablishmentSpecials(e,t){e[t].establishmentSpecials.sort(function(e,t){return e.Start_Time.localeCompare(t.Start_Time)||e.End_Time.localeCompare(t.End_Time)||e.Description.localeCompare(t.Description)})}function sortSpecials(e){e.sort(function(e,t){return e.Start_Time.localeCompare(t.Start_Time)||e.End_Time.localeCompare(t.End_Time)||e.Description.localeCompare(t.Description)})}function daysAbbreviated(e,t,s){var a=[];a=void 0===t?e[s].Days_Of_Week.split(", "):e[t].establishmentSpecials[s].Days_Of_Week.split(", ");for(var l="M",i="T",n="W",r="T",o="F",d="S",c="S",m=0;m<a.length;m++)"Monday"==a[m]?l=(l=l.fontcolor("#E63594")).bold():"Tuesday"==a[m]?i=(i=i.fontcolor("#E63594")).bold():"Wednesday"==a[m]?n=(n=n.fontcolor("#E63594")).bold():"Thursday"==a[m]?r=(r=r.fontcolor("#E63594")).bold():"Friday"==a[m]?o=(o=o.fontcolor("#E63594")).bold():"Saturday"==a[m]?d=(d=d.fontcolor("#E63594")).bold():"Sunday"==a[m]&&(c=(c=c.fontcolor("#E63594")).bold("300px"));return l+i+n+r+o+d+c}function goBack(){"establishment-page"==state?btnShowList():"establishment-page-map"==state?btnShowList():"filtered-list-map"==state&&btnShowList()}document.addEventListener("DOMContentLoaded",function(){pageOnLoad()}),$(document).on("click","#viewEstablishmentPage",function(){document.getElementById("nav-bar").scrollIntoView();for(var e=$(this).attr("data-id"),t=document.getElementById("myTable"+e),s=0,a=masterEstablishments.length;s<a;s++)if(e==masterEstablishments[s].objectId){for(var l=0;l<masterEstablishments[s].establishmentSpecials.length;l++)masterEstablishments[s].establishmentSpecials[l].otherSpecials=null;document.getElementById("rpList").innerHTML='<div><img class="rpImage" src="'+masterEstablishments[s].Image+'"><br><span class="est-name">'+masterEstablishments[s].Name+'</span><hr class="est-name-underline"><br><br><br><div class="est-details" id="estDetails"><div class="est-detail">'+masterEstablishments[s].Cuisine_Type+"</div>"+masterEstablishments[s].Address+"<br>"+masterEstablishments[s].Suburb+", "+masterEstablishments[s].Postcode+'<br><br><button class="google-website-btns google-btn btn-small" onclick="window.open(\''+masterEstablishments[s].Google_Business_Link+"');\">Directions</button></div><br><br></div>",null!=masterEstablishments[s].Website_Link&&""!=masterEstablishments[s].Website_Link&&(document.getElementById("estDetails").innerHTML+='<button class="google-website-btns btn-small" onclick="window.open(\''+masterEstablishments[s].Website_Link+"');\">Website</button>"),document.getElementById("rpList").innerHTML+='<div class="tbl-wrapper" ><table id=\'tbl\' class="striped"><colgroup><col span="1" class="tbl-special"><col span="1" class="tbl-days"></colgroup><tbody id="myTable'+s+'"></tbody></table></div>';for(var i=[],n=0,r=t.rows.length;n<r;n++)i.push(t.rows[n].id),n++;var o=[],d=masterEstablishments[s],c=[],m=0,p=d.establishmentSpecials.length;for(m=0;m<p;m++)c.push(d.establishmentSpecials[m]);var b=c,u=[];sortSpecials(u=c.filter(e=>!i.includes(e.objectId))),sortSpecials(o=b.filter(e=>i.includes(e.objectId)));for(var g=0,h=u.length;g<h;g++)u[g].otherSpecials=void 0;u.sort(function(e,t){return e.Type_Of_Special.localeCompare(t.Type_Of_Special)});if(u.length>0){u[0].otherSpecials="yes";for(var y=1,f=u.length;y<f;y++)u[y].otherSpecials="otherSpecials","Drink"==u[y].Type_Of_Special?0:0}var S,E;S=o.concat(u);for(var v=!0,k=0;k<S.length;k++){var I,T=document.getElementById("myTable"+s);I="Drink"==S[k].Type_Of_Special?'<img class="cocktail-small-img" src="images/cocktail-yellow.png">':'<img class="hamburger-small-img" src="images/burger-black.png">',0==k?(addRowTop(T,"Specials matching your search criteria",S[k].objectId),addRowTopSpecial(T,I+S[k].Description,S[k].objectId),addRowBottom(T,'<img class="time-img" src="images/clock-trans.png"><div class="time-period">'+tConvert(S[k].Start_Time)+" - "+tConvert(S[k].End_Time)+"</div>",'<img class="calander-img" src="images/calander-trans.png"><div class="daysAbbreviated">'+daysAbbreviated(S,void 0,k)+"</div>",S[k].objectId)):"yes"==S[k].otherSpecials?(addRowTop(T,"&nbsp;",S[k].objectId,"blank"),addRowTop(T,"Other specials on offer",S[k].objectId,"lightGrey"),"Drink"==S[k].Type_Of_Special?(addRowTop(T,"Drinks",S[k].objectId,"lightGrey","normal"),E="Drink"):(addRowTop(T,"Food",S[k].objectId,"lightGrey","normal"),E="Food"),addRowTopSpecial(T,I+S[k].Description,S[k].objectId,"lightGrey"),addRowBottom(T,'<img class="time-img" src="images/clock-trans.png"><div class="time-period">'+tConvert(S[k].Start_Time)+" - "+tConvert(S[k].End_Time)+"</div>",'<img class="calander-img" src="images/calander-trans.png"><div class="daysAbbreviated">'+daysAbbreviated(S,void 0,k)+"</div>",S[k].objectId,"lightGrey")):"otherSpecials"==S[k].otherSpecials?(1==v&&"Drink"==E&&"Food"==S[k].Type_Of_Special&&(addRowTop(T,"Food",S[k].objectId,"lightGrey","normal"),v=!1),addRowTopSpecial(T,I+S[k].Description,S[k].objectId,"lightGrey"),addRowBottom(T,'<img class="time-img" src="images/clock-trans.png"><div class="time-period">'+tConvert(S[k].Start_Time)+" - "+tConvert(S[k].End_Time)+"</div>",'<img class="calander-img" src="images/calander-trans.png"><div class="daysAbbreviated">'+daysAbbreviated(S,void 0,k)+"</div>",S[k].objectId,"lightGrey")):(addRowTopSpecial(T,I+S[k].Description,S[k].objectId),addRowBottom(T,'<img class="time-img" src="images/clock-trans.png"><div class="time-period">'+tConvert(S[k].Start_Time)+" - "+tConvert(S[k].End_Time)+"</div>",'<img class="calander-img" src="images/calander-trans.png"><div class="daysAbbreviated">'+daysAbbreviated(S,void 0,k)+"</div>",S[k].objectId))}document.getElementById("rpNumOfSpecialsFound").innerHTML="<u>Back to results</u>",document.getElementById("rpNumOfSpecialsFound").name=masterEstablishments[s].Name,document.getElementById("rpList").innerHTML+='<div class="est-line-break"></div>'}document.getElementById("backArrow").style.display="inline-block",state="establishment-page"});var center=function(e){var t=e.map(function(e){return e[0]}),s=e.map(function(e){return e[1]});return[(Math.min.apply(null,t)+Math.max.apply(null,t))/2,(Math.min.apply(null,s)+Math.max.apply(null,s))/2]};